<!-- Copyleft Michaelangel007 / Michael Pohoreski / mysticreddit -->
<!DOCTYPE html>
<html lang='en'>
    <head>
        <meta charset="UTF-8">
        <title>Diablo 2 Cheat Sheet by Michaelangel007</title>
        <style>

/* ----- Buttons ----- */
    button
    {
        height   : 16px;
        font-size: 12px;
        line-height: 0;  /* hack to center text vertical */
    }

    .collapsed
    {
        height    : 0px;
        max-height: 0px;
        display   : none;
    }

    .collapse
    {
        align  : right;
/*
        display: inline-block;
*/
        float  : right;
    }

    .in
    {
        display       : inline-block;
        vertical-align: 8px;
    }

    .out
    {
        height     : 30px;
        line-height: 30px;
    }

    .rejuvs
    {
        content: url("pics/rejuv.png");
    }

    .rejuvf
    {
        content: url("pics/full_rejuv.png");
    }

    // Checkboxes
    .hg
    {
    }

    .mis
    {
        color      : #F00;
        font-weight: bold;
    }

    .own
    {
        color: #080;
    }

/* ----- Breaks ----- */

     .one
     {
        height       : 1px;
        margin       :  0;
        padding      :  0;
     }

/* ----- Background Colors ----- */

    .r11
    {
        background-color: #100;
    }

    .r22
    {
        background-color: #200;
    }

    .g11
    {
        background-color: #010;
    }

    .g22
    {
        background-color: #020;
    }

    .b11
    {
        background-color: #112;
    }

    .b22
    {
        background-color: #114;
    }

    .k11
    {
        background-color: #111;
    }

    .k22
    {
        background-color: #222;
    }

    /* Act II alvl */
    .y11
    {
        background-color: #320; /* CFB997 542; */
    }

    .y22
    {
        background-color: #431; /* F4E4B7 653; */
    }


/* ----- padding ----- */

    /* Resist spacer */
    .padd
    {
        color           : #FFF;
        padding-left    : 2px;
        padding-right   : 2px;
    }

    /* Spacer before Essences */
    .padd5
    {
        padding-left: 5px;
    }

    /* Section indent */
    .padd15
    {
        padding-left: 15px;
    }

/* ----- Spans ----- */

    /* Area Levels */
    span.alvl83 { color: #0F0; }
    span.alvl84 { color: #08F; } /* 08F or F80 */
    span.alvl85 { color: #F00; }

    /* Layout -- Left / Center / Right */
    /* span.r is reserved for red which is fine for right */
    span.l { color: #4CF; } /* FF8 08F */
    span.c { color: #0F0; }


    /* Crushing Blow */
    span.cb
    {
        color: #F84;
    }

    /* Can't Be Frozen */
    span.cbf
    {
        color      : #46F;
        font-weight: bold;
    }

    /* Deadly Strike */
    span.ds
    {
        color: #FAF;
    }

    /* Damage Reduction */
    span.dr
    {
        background-color: #0AA;
        padding-left    : 2px;
        padding-right   : 2px;
    }

    /* Essences */
    span.twisted   { color: #485fb7; }
    span.charged   { color: #c8a054; }
    span.burning   { color: #b74a35; }
    span.festering { color: #00a054; }

    /* Farm Boss */
    span.farm
    {
        color: #4EF;
    }

    /* Faster Block Rate */
    span.fbr
    {
        background-color: #F00;
        color           : #FFF;
        padding-left    : 2px;
        padding-right   : 2px;
    }

    /* Faster Cast Rate */
    span.fcr
    {
        color: #4CF; /* 08F */
    }

    /* Faster Hit Recovery */
    span.fhr
    {
        background-color: #08F; /* 23A */
        color           : #FFF;
        padding-left    : 2px;
        padding-right   : 2px;
    }

    /* Gems */
    .gemam { background-color: #303; } /* Amethyst */
    .gemdi { background-color: #222; } /* Diamond  */
    .gemem { background-color: #020; } /* Emerald  */
    .gemru { background-color: #200; } /* Ruby     */
    .gemsa { background-color: #003; } /* Sapphire */
    .gemsk { background-color: #000; } /* Skull    */
    .gemto { background-color: #220; } /* Topaz    */

    /* Gold Find */
    span.gold
    {
        color: yellow;
    }

    /* Increased Attack Speed */
    span.ias
    {
        color: #4F8;
    }

    /* Ignores Target's Defense */
    span.idr
    {
        color: #4EF;
    }

    /* Getting Magic Items */
    span.mf
    {
        color: #A2F;
        font-weight: bold;
    }

    /* Level Requirement */
    span.n
    {
        color: #08F;
    }

    span.note
    {
        color     : #FF8; /* FF8 FFB Softer yellow */
        font-style: italic;
    }

    span.noterune
    {
        color: #FFF;
    }

    /* Open Wounds */
    span.ow
    {
        color: #F44;
    }

    /* Resist All */
    span.resa
    {
        /* 800 080 00C */
        /* #b55d59, #6e79b9, #f2e8a0, #57cf49 */
        background-image: linear-gradient(to right, #80423f, #4c5380, #807a54, #36802d);
        padding-left    : 2px;
        padding-right   : 2px;
    }

    /* Cold Resist % */
    span.resc
    {
        background-color: #6e79b9;
        color           : #FFF;
        padding-left    : 2px;
        padding-right   : 2px;
    }

    /* Fire Resist % */
    span.resf
    {
        background-color: #b55d59;
        color           : #FFF;
        padding-left    : 2px;
        padding-right   : 2px;
    }

    /* Physical Resist % */
    span.resh
    {
        background-color: #b8a886;
        color           : #FFF;
        padding-left    : 2px;
        padding-right   : 2px;
    }

    /* Lightning Resist % */
    span.resl
    {
        background-color: #f2e8a0;
        color           : #000;
        padding-left    : 2px;
        padding-right   : 2px;
    }

    /* Magic Resist % */
    span.resm
    {
        background-color: #c1893f;
        color           : #FFF;
        padding-left    : 2px;
        padding-right   : 2px;
    }

    /* Poison Resist % */
    span.resp
    {
        background-color: #57cf49;
        color           : #FFF;
        padding-left    : 2px;
        padding-right   : 2px;
    }

    /* Inverse */
    span.rev
    {
        background-color: #FFF;
        color           : #000;
    }

    span.rot90
    {
        display  : inline-block;
        vertical-align:text-bottom;
        transform: rotate(90deg);
    }

    span.rune
    {
        color: orange;
    }

    /* +# to skills */
    span.skill
    {
        background-image: linear-gradient(to right, #08F, #008);
    }

/* Rune Upgrades */
    /* The 'x' in number of runes needed for upgraded: 3x */
    span.x
    {
        color: #0FF;
    }

    /* The '#' of runes needed for upgraded: #x */
    span.y
    {
        color: #FF8;
    }


/* Item Types */
    span.norm
    {
        color: #fff;
    }

    span.magic
    {
        color: #46F;
    }

    span.rare
    {
        color: #d8b864;
    }

    span.set
    {
        color: #00FF00;
    }

    span.unq
    {
        color: #AA8866; // 948064
    }

/* ----- Span Borders for Selected/Unselected ----- */

    /* Holy Grail Enable */
    .hge
    {
        background-color: #666;
        border          : 1px solid #0AF;
        color           : #F80;
    }

    /* Holy Grail Disable */
    .hgd
    {
        background-color: #000;
        color           : #FF8; /* FF8 FFB Softer yellow */
    }

    /* Header Runes */
    span.sel
    {
        background-color: #666;
        border          : 1px solid #08F;
        color           : orange;
    }

    /* Header Runeword Selected */
    span.rws
    {
        background-color: #666;
        border          : 1px solid #F00;
        color           : #FFF;
    }

    /* Header Runeword Unselected */
    span.rwu
    {
        background-color: #000;
        color           : #FF8; /* FF8 FFB Softer yellow */
    }

    span.unsel
    {
        background-color: #000;
        border          : 1px solid #000;
        color           : orange;
    }

/* ---------- Table ---------- */

    .debug
    {
        border: 1px dotted cyan;
    }

    .column1
    {
        min-width: 730px; /* for mobile */
    }

    .column2
    {
        margin-left: 35px;
    }

    /* Extracted from runetip */
    .desk-runes2
    {
        width: 505px;
    }

    .pre
    {
        white-space: pre;
    }

    .size14
    {
        font-size  : 14px;
    }

    /* Treasure Class */
    .tc
    {
        color: #0AF;
    }

table.head
{
    border-collapse: collapse;
    margin         : 0;
    padding        : 0;
    text-align     : left;
    table-layout   : fixed; /* iOS */
}

th
{
    color      : #FF8; /* FF8 FFB Softer yellow */
    white-space: pre;
}

table, tr
{
    margin         : 0;
    padding        : 0;
    margin-block   : 0;
    border-spacing : 0;
    border-collapse: collapse;
}

td
{
    margin : 0;
    padding: 0;
}

/* Top and Bottom line colors */
    tr.rt
    {
        border-top   : 1px solid #F88;
        margin-top   : 1px;
    }

    tr.rb
    {
        border-bottom: 1px solid #F88;
        margin-bottom: 1px;
    }

    tr.gt
    {
        border-top   : 1px solid #8F8;
        margin-top   : 1px;
    }

    tr.gb
    {
        border-bottom: 1px solid #8F8;
        margin-bottom: 1px;
    }

    tr.bt
    {
        border-top   : 1px solid #08F;
        margin-top   : 1px;
    }

    tr.bb
    {
        border-bottom: 1px solid #08F;
        margin-bottom: 1px;
    }

    tr.kt
    {
        border-top   : 1px solid #FFF;
        margin-top   : 1px;
    }

    tr.kb
    {
        border-bottom: 1px solid #FFF;
        margin-bottom: 1px;
    }

    tr.yt
    {
        border-top   : 1px solid #FF8; /* softer yellow */
        margin-top   : 1px;
    }

    tr.yb
    {
        border-bottom: 1px solid #FF8; /* softer yellow */
        margin-bottom: 1px;
    }

    tr.raret
    {
        border-top   : 1px solid #d8b864;
        margin-top   : 1px;
    }

    tr.rareb
    {
        border-bottom: 1px solid #d8b864;
        margin-bottom: 1px;
    }

    tr.unqt
    {
        border-top   : 1px solid #948064; /* A59263; */
        margin-top   : 1px;
    }

    tr.unqb
    {
        border-bottom: 1px solid #948064;
        margin-bottom: 1px;
    }

/* Table Header */
    span.r { color: #F88; }
    span.g { color: #8F8; }
    span.b { color: #4CF; }

    .vatop
    {
        vertical-align: top;
    }

/* ---------- Tool Tips ---------- */
.runetip
{
    display       : inline-block;
    position      : relative;
    height        : 30px;
    white-space   : pre;
}

.runetip:hover
{
    background-color: #888;
    color           : #000;
    cursor          : pointer;
}

    .runetip .runehelp1
    {
        background-color: #123;
        border          : 1px solid #08F;
        border-radius   : 4px;
        color           : #ddd;
        font-family     : sans-serif;
        font-size       : 14px;
        padding         : 5px 0;
        position        : absolute;
        text-align      : center;
        visibility      : hidden;
        width           : 280px; /* Ist */
        white-space     : normal; /* runetip has pre */
        z-index         : 1;
    }

    .runetip .runehelp2
    {
        background-color: #123;
        border          : 1px solid #08F;
        border-radius   : 4px;
        color           : #ddd;
        font-family     : sans-serif;
        font-size       : 14px;
        padding         : 5px 0;
        position        : absolute;
        text-align      : center;
        visibility      : hidden;
        width           : 280px; /* Ist */
        white-space     : normal; /* runetip has pre */
        z-index         : 1;
    }

    .runetip .runehelp3
    {
        background-color: #123;
        border          : 1px solid #08F;
        border-radius   : 4px;
        color           : #ddd;
        font-family     : sans-serif;
        font-size       : 14px;
        padding         : 5px 0;
        position        : absolute;
        text-align      : center;
        visibility      : hidden;
        width           : 400px; /* 85 alvl header instructions */
        white-space     : normal; /* runetip has pre */
        z-index         : 1;
    }

.runetip .gemtext
{
    background-color: #123;
    border          : 1px solid #08F;
    border-radius   : 4px;
    color           : #ddd;
    font-family     : sans-serif;
    font-size       : 14px;
    padding         : 5px 0;
    position        : absolute;
    text-align      : center;
    visibility      : hidden;
    width           : 280px; /* Ist */
    white-space     : pre; /* see .gemhelp and gemtext */
    z-index         : 1;
}

    /* Column 1 */
    .runetip:hover .runehelp1
    {
        cursor    : pointer;
        left      : 185px; /* Single Column:  32,  185 */
        top       : 32px;  /* Multi  column: -32, -285 */
        visibility: visible;
    }

    /* Column 2 */
    .runetip:hover .runehelp2
    {
        cursor    : pointer;
        left      : -285px; /* Single Column: 32,  185 */
        top       :    0px; /* Multi  column:  0, -285 */
        visibility: visible;
    }

    .runetip:hover .runehelp3
    {
        cursor    : pointer;
        left      : 185px; /* Single Column:  32,  185 */
        top       : 32px;  /* Multi  column: -32, -285 */
        visibility: visible;
    }

.runetip:hover .gemtext
{
    cursor    : pointer;
    left      : -285px; /* Single Column: 32,  185 */
    top       :    0px; /* Multi  column:  0, -285 */
    visibility: visible;
}

.runetype
{
    color      : #fff;
    font-weight: bold;
}

.tool
{
    border          : 1px solid skyblue;
    border-radius   : 4px;
    color           : #fff;
    font-family     : sans-serif;
    font-size       : 14px;
    margin          : 0px;
    padding         : 32px 0px 32px 0px;
    position        : absolute;
    text-align      : center;
    visibility      : hidden;
    width           : 500px;  /* 1300 - 800 */
    z-index         : 1;
}

.ttr
{
    background-color: #312;
}

.ttg
{
    background-color: #132;
}

.ttb
{
    background-color: #123;
}

.ttk
{
    background-color: #222;
}

.tooltip
{
    cursor        : pointer;
    display       : inline-block;
    height        : 16px;
    position      : relative;
    vertical-align: middle;
    white-space   : pre;
}

.tooltip:hover
{
    background-color: #880; /* FF0 pure yellow; toned down for night time CC0, tweaked for highlighting runes */
    color           : #000;
    cursor          : pointer;
}

    /* Desktop column3 */
    .tooltip:hover .ttr
    {
        cursor    : pointer;
        visibility: visible;
        top       : 0px;
        left      : 1025px;
    }

    .tooltip:hover .ttg
    {
        cursor    : pointer;
        visibility: visible;
        top       : 0px;
        left      : 1025px;
    }

    .tooltip:hover .ttb
    {
        cursor    : pointer;
        visibility: visible;
        top       : 0px;
        left      : 1025px;
    }

    .tooltip:hover .ttk
    {
        cursor    : pointer;
        visibility: visible;
        top       : 0px;
        left      : 1025px;
    }

/* ----- Device ----- */

    .ios-hidden
    {
        display: block;
    }

    .ios-visible
    {
        display: none;
    }

/* iPhone Plus -- is screen width <= 767px */
@media screen and (max-width: 991.98px)
{
    .ios-hidden
    {
        display: none;
    }

    .ios-runes1
    {
        width: 550px; /* 600 Too wide */
    }

    .ios-visible
    {
        display: block;
    }

    /* Spacer between FCR/FHR/FBR and Runes */
    .column2
    {
        margin-left: 55px;
    }

    /* Single Column */
    .runetip
    {
        width         : 740px; /* auto, 615, also see: ios-runes  */
    }

    .runetip:hover .gemtext
    {
        left      : 185px; /* Single Column:  32,  185 */
        top       : 32px;  /* Multi  column: -32, -285 */
    }

    .tooltip:hover .ttr
    {
        left      : 250px;
        top       : 28px;
    }

    .tooltip:hover .ttg
    {
        left      : 250px;
        top       : 28px;
    }

    .tooltip:hover .ttb
    {
        left      : 250px;
        top       : 28px;
    }

    .tooltip:hover .ttk
    {
        left      : 250px;
        top       : 28px;
    }
}

/* ----- General ----- */

    a:visited
    {
        color          : #0F0;
/*      text-decoration: none; */
    }

    a:link
    {
        color          : #FFF; /* 8F8 */
/*      text-decoration: none; */
        font-weight    : bold
    }

    /* Runeword description: type (Shields, etc) */
    b
    {
        color: #FF8; /* Softer yellow */
    }

    body
    {
        -webkit-text-size-adjust: none; /* stop iOS from resizing th even though font size is specified */
        color           : #fff;
        background-color: #000;
        font-family     : Consolas, Menlo, Monaco, Lucida Console, monospace;
        font-size       : 16px;
        width           : 1300px; /* Obediance */
        max-width       : 1300px;
    /*
        overflow-x      : hidden;
    */
        overflow-y      : scroll;
    }

    div.c
    {
        display       : inline-block;
        vertical-align: middle;
    }

/* ----- Images ----- */
    img
    {
        margin:  0px;
        padding: 0px;
    }

    img.blank30x30
    {
        content   : url('data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==');
        width     : 30px;
        height    : 30px;
        margin    :  0px;
        padding   :  0px;
        visibility: hidden; /* FF needs this other it will render an outline box */
    }

    /* Stupid FF bug img content in css doesn't work with img */
    div.wp
    {
        content: url('pics/wp.png');
        width  : 16px;
        height : 16px;
        alt    : 'Waypoint';
    }

pre
{
    font-family: Consolas, Menlo, Monaco, Lucida Console, monospace;
    font-size  : 16px;
    margin     : 0px;
}

.ruler
{
    background-color: #222;
    border          : 0.5px dotted skyblue;
    border-radius   : 0px;
    color           : #F00;
    margin          : 0px;
    padding         : 0px 0px;
    position        : absolute;
    top             : 0px;
    height          : 3700px;
    width           : 0px;
    z-index         : 1;
}
        </style>
        <script>
"use strict"; // Stupid hack to turn on type safety

// string: rune name
// int   : min clev for rune
const RUNES =
[
    "El   ", // r00
    "Eld  ", // r01
    "Tir  ", // r02
    "Nef  ", // r03
    "Eth  ", // r04
    "Ith  ", // r05
    "Tal  ", // r06
    "Ral  ", // r07
    "Ort  ", // r08
    "Thul ", // r09
    "Amn  ", // r10
    "Sol  ", // r11
    "Shael", // r12
    "Dol  ", // r13
    "Hel  ", // r14
    "Io   ", // r15
    "Lum  ", // r16
    "Ko   ", // r17
    "Fal  ", // r18
    "Lem  ", // r19
    "Pul  ", // r20
    "Um   ", // r21
    "Mal  ", // r22
    "Ist  ", // r23
    "Gul  ", // r24
    "Vex  ", // r25
    "Ohm  ", // r26
    "Lo   ", // r27
    "Sur  ", // r28
    "Ber  ", // r29
    "Jah  ", // r30
    "Cham ", // r31
    "Zod  "  // r32
],
    RUNE_LEVS =
[
    11, // "El   "
    11, // "Eld  "
    13, // "Tir  "
    13, // "Nef  "
    15, // "Eth  "
    15, // "Ith  "
    17, // "Tal  "
    19, // "Ral  "
    21, // "Ort  "
    23, // "Thul "
    25, // "Amn  "
    27, // "Sol  "
    29, // "Shael"
    31, // "Dol  "
     0, // "Hel  "
    35, // "Io   "
    37, // "Lum  "
    39, // "Ko   "
    41, // "Fal  "
    43, // "Lem  "
    45, // "Pul  "
    47, // "Um   "
    49, // "Mal  "
    51, // "Ist  "
    53, // "Gul  "
    55, // "Vex  "
    57, // "Ohm  "
    59, // "Lo   "
    61, // "Sur  "
    63, // "Ber  "
    65, // "Jah  "
    67, // "Cham "
    69  // "Zod  "
],
SORTED =
[
    10, // "Amn  "
    29, // "Ber  "
    31, // "Cham "
    13, // "Dol  "
     0, // "El   "
     1, // "Eld  "
     4, // "Eth  "
    18, // "Fal  "
    24, // "Gul  "
    14, // "Hel  "
    15, // "Io   "
    23, // "Ist  "
     5, // "Ith  "
    30, // "Jah  "
    17, // "Ko   "
    19, // "Lem  "
    27, // "Lo   "
    16, // "Lum  "
    22, // "Mal  "
     3, // "Nef  "
    26, // "Ohm  "
     8, // "Ort  "
    20, // "Pul  "
     7, // "Ral  "
    12, // "Shael"
    11, // "Sol  "
    28, // "Sur  "
     6, // "Tal  "
     9, // "Thul "
     2, // "Tir  "
    21, // "Um   "
    25, // "Vex  "
    32  // "Zod  "
];

var COLUMNS = [ 0, 2, 22, 25, 49, 89, 93 ];
var RECIPES = [
//   S Name             Sock  Type                    Runes   #2      #3     #4    #5    #6  Lev  Version
    "  Ancient's Pledge    3  Shields                 Ral   + Ort   + Tal                     21  1.09",
    "* Black               3  Clubs/Hammers/Maces     Thul  + Io    + Nef                     35  1.09",
    "  Fury                3  Melee Weapons           Jah   + Gul   + Eth                     65  1.09",
    "  Holy Thunder        4  Scepters                Eth   + Ral   + Ort  + Tal              21  1.09",
    "  Honor               5  Melee                   Amn   + El    + Ith  + Tir + Sol        27  1.09",
    "  King's Grace        3  Swords/Scepters         Amn   + Ral   + Thul                    25  1.09",
    "* Leaf                2  Staves (Not Orbs)       Tir   + Ral                             19  1.09",
    "  Lionheart           3  Body Armor              Hel   + Lum   + Fal                     41  1.09",
    "  Lore                2  Helms                   Ort   + Sol                             27  1.09",
    "  Malice              3  Melee Weapons           Ith   + El    + Eth                     15  1.09",
    "  Melody              3  Missile Weapons         Shael + Ko    + Nef                     39  1.09",
    "  Memory              4  Staves (Not Orbs)       Lum   + Io    + Sol  + Eth              37  1.09",
    "  Nadir               2  Helms                   Nef   + Tir                             13  1.09",
    "  Radiance            3  Helms                   Nef   + Sol   + Ith                     27  1.09",
    "* Rhyme               2  Shields                 Shael + Eth                             29  1.09",
    "  Silence             6  Weapons                 Dol   + Eld   + Hel  + Ist + Tir + Vex  55  1.09",
    "  Smoke               2  Body Armor              Nef   + Lum                             37  1.09",
    "* Stealth             2  Body Armor              Tal   + Eth                             17  1.09",
    "  Steel               2  Swords/Axes/Maces       Tir   + El                              13  1.09",
    "  Strength            2  Melee Weapons           Amn   + Tir                             25  1.09",
    "  Venom               3  Weapons                 Tal   + Dol   + Mal                     49  1.09",
    "* Wealth              3  Body Armor              Lem   + Ko    + Tir                     43  1.09",
    "* White               2  Wands                   Dol   + Io                              35  1.09",
    "  Zephyr              2  Missile Weapons         Ort   + Eth                             21  1.09",

    "  Beast               5  Axes/Scepters/Hammers   Ber   + Tir   + Um   + Mal + Lum        63  1.10",
    "  Bramble             4  Body Armor              Ral   + Ohm   + Sur  + Eth              61  1.10",
    "* Breath of the Dying 6  Weapons                 Vex   + Hel   + El   + Eld + Zod + Eth  69  1.10",
    "* Call To Arms        5  Weapons                 Amn   + Ral   + Mal  + Ist + Ohm        57  1.10",
    "* Chains of Honor     4  Body Armor              Dol   + Um    + Ber  + Ist              63  1.10",
    "  Chaos               3  Claws                   Fal   + Ohm   + Um                      57  1.10",
    "  Crescent Moon       3  Axes/Swords/Polearms    Shael + Um    + Tir                     47  1.10",
    "  Delirium            3  Helms                   Lem   + Ist   + Io                      51  1.10",
    "  Doom                5  Axes/Polearms/Hammers   Hel   + Ohm   + Um   + Lo  + Cham       67  1.10",
    "  Duress              3  Body Armor              Shael + Um    + Thul                    47  1.10",
    "* Enigma              3  Body Armor              Jah   + Ith   + Ber                     65  1.10",
    "  Eternity            5  Melee Weapons           Amn   + Ber   + Ist  + Sol + Sur        63  1.10",
    "* Exile               4  Shields (Paladin only)  Vex   + Ohm   + Ist  + Dol              57  1.10",
    "  Famine              4  Axes/Hammers            Fal   + Ohm   + Ort  + Jah              65  1.10",
    "  Gloom               3  Body Armor              Fal   + Um    + Pul                     47  1.10",
    "  Hand of Justice     4  Weapons                 Sur   + Cham  + Amn  + Lo               67  1.10",
    "* Heart of the Oak    4  Staves/Maces            Ko    + Vex   + Pul  + Thul             55  1.10",
    "  Kingslayer          4  Swords/Axes             Mal   + Um    + Gul  + Fal              53  1.10",
    "  Passion             4  Weapons                 Dol   + Ort   + Eld  + Lem              43  1.10",
    "  Prudence            2  Body Armor              Mal   + Tir                             49  1.10",
    "  Sanctuary           3  Shields                 Ko    + Ko    + Mal                     49  1.10",
    "  Splendor            2  Shields                 Eth   + Lum                             37  1.10",
    "  Stone               4  Body Armor              Shael + Um    + Pul  + Lum              47  1.10",
    "  Wind                2  Melee Weapons           Sur   + El                              61  1.10",

    "  Brand               4  Missile Weapons         Jah   + Lo    + Mal  + Gul              65  1.10 lad",
    "  Death               5  Swords/Axes             Hel   + El    + Vex  + Ort + Gul        55  1.10 lad",
    "  Destruction         5  Polearms/Swords         Vex   + Lo    + Ber  + Jah + Ko         65  1.10 lad",
    "  Dragon              3  Body Armor/Shields      Sur   + Lo    + Sol                     61  1.10 lad",
    "  Dream               3  Helms/Shields           Io    + Jah   + Pul                     65  1.10 lad",
    "  Edge                3  Missile Weapons         Tir   + Tal   + Amn                     25  1.10 lad",
    "  Faith               4  Missile Weapons         Ohm   + Jah   + Lem  + Eld              65  1.10 lad",
    "* Fortitude           4  Weapons/Body Armor      El    + Sol   + Dol  + Lo               59  1.10 lad",
    "* Grief               5  Swords/Axes             Eth   + Tir   + Lo   + Mal + Ral        59  1.10 lad",
    "  Harmony             4  Missile Weapons         Tir   + Ith   + Sol  + Ko               39  1.10 lad",
    "  Ice                 4  Missile Weapons         Amn   + Shael + Jah  + Lo               65  1.10 lad",
    "* Infinity            4  Polearms                Ber   + Mal   + Ber  + Ist              63  1.10 lad",
    "* Insight             4  Polearms/Staves         Ral   + Tir   + Tal  + Sol              27  1.10 lad",
    "* Last Wish           6  Swords/Hammers/Axes     Jah   + Mal   + Jah  + Sur + Jah + Ber  65  1.10 lad",
    "  Lawbringer          3  Swords/Hammers/Scepters Amn   + Lem   + Ko                      43  1.10 lad",
    "  Oath                4  Swords/Axes/Maces       Shael + Pul   + Mal  + Lum              49  1.10 lad",
    "* Obedience           5  Polearms                Hel   + Ko    + Thul + Eth + Fal        41  1.10 lad",
    "  Phoenix             4  Weapons/Shields         Vex   + Vex   + Lo   + Jah              65  1.10 lad",
    "  Pride               4  Polearms                Cham  + Sur   + Io   + Lo               67  1.10 lad",
    "  Rift                4  Polearms/Scepters       Hel   + Ko    + Lem  + Gul              53  1.10 lad",
    "* Spirit              4  Swords/Shields          Tal   + Thul  + Ort  + Amn              25  1.10 lad",
    "  Voice of Reason     4  Swords/Maces            Lem   + Ko    + El   + Eld              43  1.10 lad",
    "  Wrath               4  Missile Weapons         Pul   + Lum   + Ber  + Mal              63  1.10 lad",

    "  Bone                3  Body Armor              Sol   + Um    + Um                      47  1.11",
    "  Enlightenment       3  Body Armor              Pul   + Ral   + Sol                     45  1.11",
    "  Myth                3  Body Armor              Hel   + Amn   + Nef                     25  1.11",
    "  Peace               3  Body Armor              Shael + Thul  + Amn                     29  1.11",
    "  Principle           3  Body Armor              Ral   + Gul   + Eld                     53  1.11",
    "  Rain                3  Body Armor              Ort   + Mal   + Ith                     49  1.11",
    "* Treachery           3  Body Armor              Shael + Thul  + Lem                     43  1.11"
];

    //  &check;  \u2713  Check Mark
    //  &#x2610; \u2610  Ballot Box
    //  &#x2611; \u2611  Ballot Box with Check
    const FACE     = [ '-', '+' ], // Button collapse faces
          FAVS     = [ '\u2610', '\u2611' ],
          COLLAPSE = [ 'Collapse', 'Expand' ],
                   //TC 0, 3, 6, 9,12,15,18,21,24,27,30,33,36,39,42,45,48,51,54,57, 60,63,66,69,72,75,78,81,84,87
          TC_SETS  = [ 11, 8, 2, 6, 7, 6, 3,10, 7, 6, 3, 1, 3, 6, 1, 5, 3, 7, 3, 2, 0, 2, 2, 1, 0, 3, 3, 2, 6, 8 ],
          TC_UNQS  = [ 21,15,10,11,14,10, 8,14,11,10, 8,15,20,17,15,17,13,17,13, 7, 6,11, 6, 6,10,11, 9,11,11,21 ],
          NUM_SETS = 127,
          NUM_UNQS = 368,
          NUM_HOLY = NUM_SETS + NUM_UNQS,
          HG_COLS  = [ 0, 5, 26, 56 ], // Holy Grail Columns
          HG_EMPTY = '---',
          ITEMS    = // NOTE: Autogenerated by treasureclass/tc.cpp
[
"TC87 Archon Staff         ---                           Mang Song's Lesson        ",
"TC87 Berserker Axe        ---                           Death Cleaver             ",
"TC87 Bloodlord Skull      ---                           Darkforce Spawn           ",
"TC87 Caduceus             Griswold's Redemption         Astreon's Iron Ward       ",
"TC87 Colossus Blade       Bul-Kathos' Sacred Charge     The Grandfather           ",
"TC87 Corona               Griswold's Valor              Crown of Ages             ",
"TC87 Diadem               M'avina's True Sight          Griffon's Eye             ",
"TC87 Dimensional Shard    ---                           Death's Fathom            ",
"TC87 Giant Thresher       ---                           Stormspire                ",
"TC87 Glorious Axe         ---                           Executioner's Justice     ",
"TC87 Hydra Bow            ---                           Windforce                 ",
"TC87 Legend Spike         ---                           Ghostflame                ",
"TC87 Myrmidon Greaves     ---                           Shadow Dancer             ",
"TC87 Mythical Sword       Bul-Kathos' Tribal Guardian   ---                       ",
"TC87 Ogre Gauntlets       ---                           Steelrend                 ",
"TC87 Sacred Armor         Immortal King's Soul Cage     Tyrael's Might            ",
"TC87 Sacred Armor         ---                           Templar's Might           ",
"TC87 Scissors Suwayyah    Natalya's Mark                ---                       ",
"TC87 Thunder Maul         ---                           Earth Shifter             ",
"TC87 Thunder Maul         ---                           The Cranium Basher        ",
"TC87 Unearthed Wand       ---                           Death's Web               ",
"TC87 Vortex Shield        Griswold's Honor              ---                       ",
"TC87 War Pike             ---                           Steel Pillar              ",
"TC87 Winged Harpoon       ---                           Gargoyle's Bite           ",
"TC84 Bone Visage          Trang-Oul's Guise             Giant Skull               ",
"TC84 Champion Axe         ---                           Messerschmidt's Reaver    ",
"TC84 Cryptic Sword        Sazabi's Cobalt Redeemer      Frostwind                 ",
"TC84 Demon Crossbow       ---                           Gut Siphon                ",
"TC84 Fanged Knife         ---                           Fleshripper               ",
"TC84 Lacquered Plate      Tal Rasha's Guardianship      ---                       ",
"TC84 Legendary Mallet     ---                           Schaefer's Hammer         ",
"TC84 Legendary Mallet     ---                           Stone Crusher             ",
"TC84 Shadow Plate         Aldur's Deception             Steel Carapace            ",
"TC84 Sky Spirit           ---                           Ravenlore                 ",
"TC84 Troll Belt           Trang-Oul's Girth             ---                       ",
"TC84 Ward                 Taebaek's Glory               Spirit Ward               ",
"TC84 Zakarum Shield       ---                           Dragonscale               ",
"TC81 Aegis                ---                           Medusa's Gaze             ",
"TC81 Conquerer Crown      ---                           Halaberd's Reign          ",
"TC81 Cryptic Axe          ---                           Tomb Reaver               ",
"TC81 Ghost Glaive         ---                           Wraith Flight             ",
"TC81 Kraken Shell         M'avina's Embrace             Leviathan                 ",
"TC81 Spired Helm          Ondal's Almighty              Veil of Steel             ",
"TC81 Spired Helm          ---                           Nightwing's Veil          ",
"TC81 Succubus Skull       ---                           Boneflame                 ",
"TC81 Ward Bow             ---                           Widowmaker                ",
"TC81 War Spike            ---                           Cranebeak                 ",
"TC81 Winged Axe           ---                           Lacerator                 ",
"TC78 Balrog Skin          Sazabi's Ghost Liberator      Arkaine's Valor           ",
"TC78 Champion Sword       ---                           Doombringer               ",
"TC78 Crusader Bow         ---                           Eaglehorn                 ",
"TC78 Earth Spirit         ---                           Spirit Keeper             ",
"TC78 Feral Claws          ---                           Firelizard's Talons       ",
"TC78 Grand Matron Bow     M'avina's Caster              ---                       ",
"TC78 Hellforge Plate      Naj's Light Plate             ---                       ",
"TC78 Scourge              ---                           Horizon's Tornado         ",
"TC78 Scourge              ---                           Stormlash                 ",
"TC78 Troll Nest           ---                           Head Hunter's Glory       ",
"TC78 Winged Knife         ---                           Warshrike                 ",
"TC75 Battle Cestus        ---                           Shadow Killer             ",
"TC75 Colossus Crossbow    ---                           Hellrack                  ",
"TC75 Decapitator          ---                           Hellslayer                ",
"TC75 Demonhead            ---                           Andariel's Visage         ",
"TC75 Destroyer Helm       ---                           Demonhorn's Edge          ",
"TC75 Elder Staff          Naj's Puzzler                 Ondal's Wisdom            ",
"TC75 Lich Wand            ---                           Boneshade                 ",
"TC75 Loricated Mail       Natalya's Shadow              ---                       ",
"TC75 Mancatcher           ---                           Viperfork                 ",
"TC75 Mithril Coil         Credendum                     Verdungo's Hearty Cord    ",
"TC75 Phase Blade          ---                           Azurewrath                ",
"TC75 Phase Blade          ---                           Lightsabre                ",
"TC72 Balrog Blade         ---                           Flamebellow               ",
"TC72 Balrog Spear         ---                           Demon's Arch              ",
"TC72 Boneweave Boots      ---                           Marrowwalk                ",
"TC72 Devil Star           ---                           Baranar's Star            ",
"TC72 Ettin Axe            ---                           Rune Master               ",
"TC72 Monarch              ---                           Stormshield               ",
"TC72 Sacred Rondache      ---                           Alma Negra                ",
"TC72 Thresher             ---                           The Reaper's Toll         ",
"TC72 Tiara                ---                           Kira's Guardian           ",
"TC72 Wire Fleece          ---                           The Gladiator's Bane      ",
"TC69 Armet                ---                           Steelshade                ",
"TC69 Blade Barrier        ---                           Spike Thorn               ",
"TC69 Eldritch Orb         ---                           Eschuta's Temper          ",
"TC69 Ogre Maul            Immortal King's Stone Crusher Windhammer                ",
"TC69 Vambraces            ---                           Soul Drainer              ",
"TC69 Vampirefang Belt     ---                           Nosferatu's Coil          ",
"TC66 Dusk Shroud          Dark Adherent                 Ormus' Robes              ",
"TC66 Fury Visor           ---                           Wolfhowl                  ",
"TC66 Matriarchal Javelin  ---                           Thunderstroke             ",
"TC66 Ornate Armor         Griswold's Heart              Corpsemourn               ",
"TC66 Scarabshell Boots    ---                           Sandstorm Trek            ",
"TC66 Silver Edged Axe     ---                           Ethereal Edge             ",
"TC63 Ataghan              ---                           Djinn Slayer              ",
"TC63 Blood Spirt          ---                           Cerebus' Bite             ",
"TC63 Chaos Armor          Trang-Oul's Scales            Black Hades               ",
"TC63 Elegant Blade        ---                           Bloodmoon                 ",
"TC63 Luna                 ---                           Blackoak Shield           ",
"TC63 Matriarchal Spear    ---                           Stoneraven                ",
"TC63 Mighty Scepter       ---                           Heaven's Light            ",
"TC63 Mighty Scepter       ---                           The Redeemer              ",
"TC63 Reinforced Mace      Dangoon's Teaching            ---                       ",
"TC63 Spiderweb Sash       ---                           Arachnid Mesh             ",
"TC63 Vampirebone Gloves   ---                           Dracul's Grasp            ",
"TC63 Wrist Sword          ---                           Jade Talon                ",
"TC60 Bone Knife           ---                           Wizardspike               ",
"TC60 Embossed Plate       ---                           Atma's Wail               ",
"TC60 Hyperion Spear       ---                           Arioc's Needle            ",
"TC60 Mage Plate           ---                           Que-Hegan's Wisdom        ",
"TC60 Ogre Axe             ---                           Bonehew                   ",
"TC60 Shako                ---                           Harlequin Crest           ",
"TC57 Ancient Shield       ---                           Radament's Sphere         ",
"TC57 Bramble Mitts        Laying of Hands               ---                       ",
"TC57 Flying Axe           ---                           Gimmershred               ",
"TC57 Grand Crown          Hwanin's Splendor             Crown of Thieves          ",
"TC57 Grim Scythe          ---                           Grim's Burning Dead       ",
"TC57 Sharktooth Armor     ---                           Toothrow                  ",
"TC57 Totemic Mask         ---                           Jalal's Mane              ",
"TC57 Tyrant Club          ---                           Demon Limb                ",
"TC54 Chu-Ko-Nu            ---                           Demon Machine             ",
"TC54 Executioner Sword    ---                           Swordguard                ",
"TC54 Gothic Bow           ---                           Goldstrike Arch           ",
"TC54 Hierophant Trophy    ---                           Homunculus                ",
"TC54 Martel de Fer        ---                           The Gavel of Pain         ",
"TC54 Matriarchal Bow      ---                           Bloodraven's Charge       ",
"TC54 Slayer Guard         ---                           Arreat's Face             ",
"TC54 Templar Coat         ---                           Guardian Angel            ",
"TC54 Tomahawk             ---                           Razor's Edge              ",
"TC54 Truncheon            ---                           Nord's Tenderizer         ",
"TC54 War Belt             Immortal King's Detail        Thundergod's Vigor        ",
"TC54 War Boots            Immortal King's Pillar        Gore Rider                ",
"TC54 War Gauntlets        Immortal King's Forge         Hellmouth                 ",
"TC51 Ancient Axe          ---                           The Minotaur              ",
"TC51 Ancient Sword        ---                           The Atlantean             ",
"TC51 Battle Belt          Wilhelm's Pride               Snowclash                 ",
"TC51 Battle Boots         Aldur's Advance               War Traveler              ",
"TC51 Battle Gauntlets     M'avina's Icy Clutch          Lava Gout                 ",
"TC51 Bec-de-Corbin        ---                           Husoldal Evo              ",
"TC51 Cantor Trophy        Trang-Oul's Wing              ---                       ",
"TC51 Ceremonial Pike      ---                           Lycander's Flank          ",
"TC51 Grave Wand           ---                           Blackhand Key             ",
"TC51 Greater Talons       ---                           Bartuc's Cut-Throat       ",
"TC51 Grim Helm            Natalya's Totem               Vampire Gaze              ",
"TC51 Gilded Shield        ---                           Herald of Zakarum         ",
"TC51 Pavise               ---                           Gerke's Sanctuary         ",
"TC51 Rune Bow             ---                           Magewrath                 ",
"TC51 Russet Armor         ---                           Skullder's Ire            ",
"TC51 Swirling Crystal     Tal Rasha's Lidless Eye       The Oculus                ",
"TC51 Winged Helm          Guillaume's Face              Valkyrie Wing             ",
"TC51 Zweihander           ---                           Todesfaelle Flamme        ",
"TC48 Ballista             ---                           Buriza-Do Kyanon          ",
"TC48 Battle Hammer        ---                           Earthshaker               ",
"TC48 Ceremonial Bow       ---                           Lycander's Aim            ",
"TC48 Cuirass              Haemosu's Adamant             Duriel's Shell            ",
"TC48 Death Mask           Tal Rasha's Horadric Crest    Blackhorn's Face          ",
"TC48 Gothic Axe           ---                           Boneslayer Blade          ",
"TC48 Gothic Sword         ---                           Cloudcrack                ",
"TC48 Grim Shield          ---                           Lidless Wall              ",
"TC48 Hunter's Guise       Aldur's Stony Gaze            ---                       ",
"TC48 Lance                ---                           Spire of Honor            ",
"TC48 Large Siege Bow      ---                           Cliffkiller               ",
"TC48 Naga                 ---                           Guardian Naga             ",
"TC48 Rune Staff           ---                           Skull Collector           ",
"TC48 Stiletto             ---                           Stormspike                ",
"TC45 Basinet              Sazabi's Mental Sheath        Darksight Helm            ",
"TC45 Crowbill             ---                           Pompeii's Wrath           ",
"TC45 Cutlass              ---                           Coldsteel Eye             ",
"TC45 Divine Scepter       ---                           Hand of Blessed Light     ",
"TC45 Dragon Shield        ---                           Tiamat's Rebuke           ",
"TC45 Heavy Bracers        Trang-Oul's Claws             Ghoulhide                 ",
"TC45 Knout                ---                           Baezil's Vortex           ",
"TC45 Mesh Armor           ---                           Shaftstop                 ",
"TC45 Mesh Belt            Tal Rasha's Fire-Spun Cloth   Gloom's Trap              ",
"TC45 Mesh Boots           Natalya's Soul                Silkweave                 ",
"TC45 Rune Sword           ---                           Plague Bearer             ",
"TC45 Short Siege Bow      ---                           Witchwild String          ",
"TC45 Tigulated Mail       Hwanin's Refuge               Crow Caw                  ",
"TC45 Tomb Wand            ---                           Arm of King Leoric        ",
"TC45 Tusk Sword           ---                           The Vile Husk             ",
"TC45 War Club             ---                           Bloodtree Stump           ",
"TC45 Yari                 ---                           Hone Sundan               ",
"TC42 Ancient Armor        Milabrega's Robe              Silks of the Victor       ",
"TC42 Barbed Shield        ---                           Lance Guard               ",
"TC42 Battle Scythe        ---                           Athena's Wrath            ",
"TC42 Battle Sword         ---                           Headstriker               ",
"TC42 Casque               ---                           Stealskull                ",
"TC42 Cinquedeas           ---                           Blackbog's Sharp          ",
"TC42 Dacian Falx          ---                           Bing Sz Wang              ",
"TC42 Gothic Staff         ---                           Warpspear                 ",
"TC42 Holy Water Sprinkler ---                           The Fetid Sprinkler       ",
"TC42 Linked Mail          ---                           Spirit Forge              ",
"TC42 Scutum               ---                           Stormchaser               ",
"TC42 Siege Crossbow       ---                           Pus Spitter               ",
"TC42 Tabar                ---                           Stormrider                ",
"TC42 Trellised Armor      ---                           Iron Pelt                 ",
"TC42 War Fork             ---                           Soulfeast Tine            ",
"TC39 Bearded Axe          ---                           Spellsteel                ",
"TC39 Bill                 Hwanin's Justice              Blackleach Blade          ",
"TC39 Cedar Staff          ---                           Chromatic Ire             ",
"TC39 Demonhide Armor      ---                           Skin of the Flayed One    ",
"TC39 Dimensional Blade    ---                           Ginther's Rift            ",
"TC39 Double Bow           ---                           Endlesshail               ",
"TC39 Espadon              ---                           Crainte Vomir             ",
"TC39 Full Plate Mail      Tancred's Spine               Goldskin                  ",
"TC39 Jagged Star          Aldur's Rythm                 Moonfall                  ",
"TC39 Petrified Wand       ---                           Carin Shard               ",
"TC39 Round Shield         Whitstan's Guard              Moser's Blessed Circle    ",
"TC39 Sallet               ---                           Rockstopper               ",
"TC39 Sharkskin Belt       M'avina's Tenet               Razortail                 ",
"TC39 Sharkskin Boots      ---                           Waterwalk                 ",
"TC39 Sharkskin Gloves     Magnus' Skin                  Gravepalm                 ",
"TC39 Tulwar               ---                           Blade of Ali Baba         ",
"TC39 Twin Axe             ---                           Islestrike                ",
"TC36 Arbalest             ---                           Langer Briser             ",
"TC36 Cedar Bow            ---                           Kuko Shakaku              ",
"TC36 Ceremonial Javelin   ---                           Titan's Revenge           ",
"TC36 Cleaver              ---                           Butcher's Pupil           ",
"TC36 Defender             ---                           Viscerataunt              ",
"TC36 Demonhide Boots      Rite of Passage               Infernostride             ",
"TC36 Demonhide Sash       ---                           String of Ears            ",
"TC36 Flanged Mace         ---                           Sureshrill Frost          ",
"TC36 Francisca            ---                           The Scalper               ",
"TC36 Fuscina              ---                           Kelpie Snare              ",
"TC36 Ghost Armor          ---                           The Spirit Shroud         ",
"TC36 Light Plate          Arcanna's Flesh               Heavenly Garb             ",
"TC36 Military Axe         ---                           Warlord's Trust           ",
"TC36 Partizan             ---                           Pierre Tombale Couant     ",
"TC36 Quarterstaff         ---                           Ribcracker                ",
"TC36 Rondel               ---                           Heart Carver              ",
"TC36 Serpentskin Armor    ---                           Skin of the Vipermagi     ",
"TC36 Shamshir             ---                           Hexfire                   ",
"TC36 War Hat              Cow King's Horns              Peasant Crown             ",
"TC36 War Scythe           ---                           The Grim Reaper           ",
"TC33 Barbed Club          ---                           Fleshrender               ",
"TC33 Battle Dart          ---                           Deathbit                  ",
"TC33 Burnt Wand           ---                           Suicide Branch            ",
"TC33 Demonhide Gloves     ---                           Venom Grip                ",
"TC33 Gothic Plate         Sigon's Shelter               Rattlecage                ",
"TC33 Great Maul           ---                           Steeldriver               ",
"TC33 Great Sword          ---                           The Patriarch             ",
"TC33 Hatchet              ---                           Coldkill                  ",
"TC33 Lochaber Axe         ---                           The Meat Scraper          ",
"TC33 Long War Bow         ---                           Blastbark                 ",
"TC33 Poignard             ---                           Spineripper               ",
"TC33 Razor Bow            ---                           Riphook                   ",
"TC33 Repeating Crossbow   ---                           Doomslinger               ",
"TC33 Rune Scepter         ---                           Zakarum's Hand            ",
"TC33 War Spear            ---                           The Impaler               ",
"TC30 Crown                Iratha's Coil                 Undead Crown              ",
"TC30 Crown                Milabrega's Diadem            ---                       ",
"TC30 Cudgel               ---                           Dark Clan Crusher         ",
"TC30 Edge Bow             ---                           Skystrike                 ",
"TC30 Field Plate          ---                           Rockfleece                ",
"TC30 Gladius              ---                           Bloodletter               ",
"TC30 Gothic Shield        Isenhart's Parry              The Ward                  ",
"TC30 Halberd              ---                           Woestave                  ",
"TC30 Jo Staff             ---                           Razorswitch               ",
"TC27 Flamberge            ---                           Ripsaw                    ",
"TC27 Gauntlets            Sigon's Gage                  Frostburn                 ",
"TC27 Giant Axe            ---                           Humongous                 ",
"TC27 Greaves              Sigon's Sabot                 Tearhaunch                ",
"TC27 Grim Wand            Infernal Torch                Ume's Lament              ",
"TC27 Plated Belt          Sigon's Wrap                  Bladebuckle               ",
"TC27 Short War Bow        Arctic Horn                   Hellclap                  ",
"TC27 War Axe              ---                           Rakescar                  ",
"TC27 War Hammer           ---                           Ironstone                 ",
"TC27 War Sword            Death's Touch                 Culwen's Point            ",
"TC24 Avenger Guard        Immortal King's Will          ---                       ",
"TC24 Bastard Sword        ---                           Blacktongue               ",
"TC24 Blade                ---                           Spectral Shard            ",
"TC24 Bone Helm            Tancred's Skull               Wormskull                 ",
"TC24 Circlet              Naj's Circlet                 ---                       ",
"TC24 Great Axe            ---                           Brainhew                  ",
"TC24 Great Helm           Sigon's Visor                 Howltusk                  ",
"TC24 Heavy Crossbow       ---                           Hellcast                  ",
"TC24 Long Battle Bow      Vidala's Barb                 Wizendraw                 ",
"TC24 Pike                 ---                           The Tannr Gorerod         ",
"TC24 Plate Mail           ---                           Boneflesh                 ",
"TC24 Tower Shield         Sigon's Guard                 Bverrit Keep              ",
"TC24 War Staff            Arcanna's Deathwand           The Iron Jang Bong        ",
"TC21 Bone Shield          ---                           Wall of the Eyeless       ",
"TC21 Flail                ---                           The General's Tan Do Li Ga",
"TC21 Giant Sword          ---                           Kinemil's Awl             ",
"TC21 Heavy Belt           Iratha's Cord                 Goldwrap                  ",
"TC21 Heavy Belt           Infernal Sign                 ---                       ",
"TC21 Light Gauntlets      Iratha's Cuff                 Magefist                  ",
"TC21 Light Gauntlets      Arctic Mitts                  ---                       ",
"TC21 Light Plated Boots   Vidala's Fetlock              Goblin Toe                ",
"TC21 Long Sword           Cleglaw's Tooth               Hellplague                ",
"TC21 Mask                 Cathan's Visage               The Face of Horror        ",
"TC21 Maul                 ---                           Bonesnap                  ",
"TC21 Military Pick        Tancred's Crowbill            Skull Splitter            ",
"TC21 Poleaxe              ---                           The Battlebranch          ",
"TC21 Spetum               ---                           Lance of Yaggai           ",
"TC21 Splint Mail          Berserker's Hauberk           Iceblink                  ",
"TC21 War Scepter          Milabrega's Rod               Stormeye                  ",
"TC18 Battle Axe           ---                           The Chieftain             ",
"TC18 Battle Staff         Cathan's Rule                 The Salamander            ",
"TC18 Bone Wand            Sander's Superstition         Gravenspine               ",
"TC18 Brandistock          ---                           Bloodthief                ",
"TC18 Breast Plate         Isenhart's Case               Venom Ward                ",
"TC18 Claymore             ---                           Soulflay                  ",
"TC18 Kris                 ---                           The Jade Tan Do           ",
"TC18 Short Battle Bow     ---                           Stormstrike               ",
"TC15 Broad Sword          Isenhart's Lightbrand         Griswold's Edge           ",
"TC15 Chain Mail           Cathan's Mesh                 Sparking Mail             ",
"TC15 Crossbow             ---                           Ichorsting                ",
"TC15 Double Axe           Berserker's Hatchet           Bladebone                 ",
"TC15 Full Helm            Isenhart's Horns              Duskdeep                  ",
"TC15 Grand Scepter        Civerb's Cudgel               Rusthandle                ",
"TC15 Kite Shield          Milabrega's Orb               Steelclash                ",
"TC15 Morning Star         ---                           Bloodrise                 ",
"TC15 Scale Mail           ---                           Hawkmail                  ",
"TC15 Scythe               ---                           Soul Harvest              ",
"TC12 Belt                 Hsarus' Iron Stay             Nightsmoke                ",
"TC12 Belt                 Hwanin's Blessing             ---                       ",
"TC12 Broad Axe            ---                           Goreshovel                ",
"TC12 Chain Boots          Hsarus' Iron Heel             Treads of Cthon           ",
"TC12 Chain Gloves         Cleglaw's Pincers             Chance Guards             ",
"TC12 Composite Bow        ---                           Rogue's Bow               ",
"TC12 Falchion             ---                           Gleamscythe               ",
"TC12 Gnarled Staff        ---                           Spire of Lazarus          ",
"TC12 Helm                 Berserker's Headgear          Coif of Glory             ",
"TC12 Large Shield         Civerb's Ward                 Stormguild                ",
"TC12 Ring Mail            Angelic Mantle                Darkglow                  ",
"TC12 Spiked Shield        ---                           Swordback Hold            ",
"TC12 Two-Handed Sword     ---                           Shadowfang                ",
"TC12 Voulge               ---                           Steelgoad                 ",
"TC12 Yew Wand             ---                           Maelstrom                 ",
"TC09 Axe                  ---                           Deathspade                ",
"TC09 Dirk                 ---                           The Diggler               ",
"TC09 Heavy Boots          Cow King's Hooves             Gorefoot                  ",
"TC09 Heavy Boots          Sander's Riprap               ---                       ",
"TC09 Heavy Gloves         Sander's Taboo                Bloodfist                 ",
"TC09 Light Belt           Artic Binding                 Snakecord                 ",
"TC09 Long Bow             ---                           Raven Claw                ",
"TC09 Long Staff           ---                           Serpent Lord              ",
"TC09 Mace                 ---                           Crushflange               ",
"TC09 Sabre                Angelic Sickle                Skewer of Krintiz         ",
"TC09 Studded Leather      Cow King's Hide               Twitchthroe               ",
"TC09 Trident              ---                           Razortine                 ",
"TC06 Bardiche             ---                           Dimoak's Hew              ",
"TC06 Hard Leather Armor   ---                           The Centurion             ",
"TC06 Hunter's Bow         ---                           Witherstring              ",
"TC06 Large Axe            ---                           Axe of Fechmar            ",
"TC06 Light Crossbow       ---                           Leadcrow                  ",
"TC06 Scimitar             ---                           Blood Crescent            ",
"TC06 Skull Cap            Arcanna's Head                Tarnhelm                  ",
"TC06 Small Shield         Cleglaw's Claw                Umbral Disk               ",
"TC06 Spear                ---                           The Dragon Chang          ",
"TC06 Spiked Club          ---                           Stoutnail                 ",
"TC03 Boots                Tancred's Hobnails            Hotspur                   ",
"TC03 Buckler              Hsarus' Iron Fist             Pelta Lunata              ",
"TC03 Cap                  Infernal Cranium              Biggin's Bonnet           ",
"TC03 Cap                  Sander's Paragon              ---                       ",
"TC03 Club                 ---                           Felloak                   ",
"TC03 Dagger               ---                           Gull                      ",
"TC03 Hand Axe             ---                           The Gnasher               ",
"TC03 Leather Armor        Vidala's Ambush               Blinkbat's Form           ",
"TC03 Leather Gloves       Death's Hand                  The Hand of Broc          ",
"TC03 Quilted Armor        Arctic Furs                   Greyform                  ",
"TC03 Sash                 Death's Guard                 Lenymo                    ",
"TC03 Scepter              ---                           Knell Striker             ",
"TC03 Short Bow            ---                           Pluckeye                  ",
"TC03 Short Staff          ---                           Bane Ash                  ",
"TC03 Short Sword          ---                           Rixot's Keen              ",
"TC03 Wand                 ---                           Torch of Iro              ",
"TC00 Amulet               Angelic Wings                 Atma's Scarab             ",
"TC00 Amulet               Arcanna's Sign                Crescent Moon             ",
"TC00 Amulet               Cathan's Sigil                Highlord's Wrath          ",
"TC00 Amulet               Civerb's Icon                 Mara's Kaleidoscope       ",
"TC00 Amulet               Iratha's Collar               Metalgrid                 ",
"TC00 Amulet               Tal Rasha's Adjudication      Nokozan Relic             ",
"TC00 Amulet               Tancred's Weird               Saracen's Chance          ",
"TC00 Amulet               Telling of Beads              Seraph's Hymn             ",
"TC00 Amulet               Vidala's Snare                The Cat's Eye             ",
"TC00 Amulet               ---                           The Eye of Etlich         ",
"TC00 Amulet               ---                           The Mahim-Oak Curio       ",
"TC00 Amulet               ---                           The Rising Sun            ",
"TC00 Ring                 Angelic Halo                  Bul-Kathos' Wedding Band  ",
"TC00 Ring                 Cathan's Seal                 Carrion Wind              ",
"TC00 Ring                 ---                           Dwarf Star                ",
"TC00 Ring                 ---                           Manald Heal               ",
"TC00 Ring                 ---                           Nagelring                 ",
"TC00 Ring                 ---                           Nature's Peace            ",
"TC00 Ring                 ---                           Raven Frost               ",
"TC00 Ring                 ---                           Stone of Jordan           ",
"TC00 Ring                 ---                           Wisp Projector            "
];

// Globals
    var gaAvailableRunes    = [], // saved
        gaFavoriteRuneWords = [], // saved
        gaRuneWordManifest  = [],

        gaRuneWordLevel  = [],
        gaRuneWordNames  = [],
        gaRuneWordRunes  = [], // array of runes
        gaRuneWordMats   = [], // array of strings
        gaRuneWordSocks  = [],
        gaRuneWordSuper  = [],
        gaRuneWordType   = [],
        gaRuneWordVer    = [],

        gaSortByLevel    = [],
        gaSortByMats1    = [],
        gaSortByMats2    = [],
        gaSortByMats3    = [],
        gaSortByMats4    = [],
        gaSortByMats5    = [],
        gaSortByMats6    = [],
        gaSortByNames    = [],
        gaSortByOwned    = [], // Sort runewords by runes owned
        gaSortBySockets  = [],
        gaSortBySuperior = [],
        gaSortByType     = [],
        gaSortByVersion  = [],

        gaHolyGrailSets  = [], //saved
        gaHolyGrailUnqs  = [], //saved

        gaHolyGrailDataBaseName = [], // string, base name
        gaHolyGrailDataSetsName = [], // string, set  name
        gaHolyGrailDataUnqsName = [], // string, uniq name
        gaHolyGrailDataTC       = [], // string, Treasure Class

        gaHolyGrailSortByBaseName = [],
        gaHolyGrailSortBySetsName = [],
        gaHolyGrailSortBySetsOwn  = [],
        gaHolyGrailSortByUnqsName = [],
        gaHolyGrailSortByUnqsOwn  = [],
        gaHolyGrailSortByTC       = [],

        gaHolyGrailMapRowToSets = [],
        gaHolyGrailMapRowToUnqs = [];

    var gaRuneOrder =
    [
        null,
        gaSortByMats1,
        gaSortByMats2,
        gaSortByMats3,
        gaSortByMats4,
        gaSortByMats5,
        gaSortByMats6
    ];

function DumpHolyGrail()
{
    var tc, totalSets = 0, totalUnqs = 0;

    for( tc = 0; tc < TC_SETS.length; tc++ )
        totalSets += TC_SETS[ tc ];

    for( tc = 0; tc < TC_UNQS.length; tc++ )
        totalUnqs += TC_UNQS[ tc ];

    console.log( "Total Sets:  ", totalSets );
    console.log( "Total Unqs:  ", totalUnqs );
    console.log( "Total items: ",(totalSets + totalUnqs) );
    console.log( "ITEMS[] len: ", ITEMS.length );

    if (totalSets != NUM_SETS)
        console.error( "Missing set items! ", totalSets, " / ", NUM_SETS );

    if (totalUnqs != NUM_UNQS)
        console.error( "Missing unq items! ", totalUnqs, " / ", NUM_UNQS );
}

function DumpHolyGrailSorted( name, array )
{
    console.warn( '--- ' + name + ' ---\n' );

    var iHG, item, items = ITEMS.length, text = '';
    for( item = 0; item < items; item++ )
    {
        iHG = array[ item ];
        text += '#' + padLeft( item, 3 )
             + ' [' + padLeft( iHG, 3 )          + '] '
             + gaHolyGrailDataTC      [ iHG ]         + ' '
             + gaHolyGrailDataBaseName[ iHG ]         + ' '
             + gaHolyGrailDataSetsName[ iHG ]         + ' '
             + gaHolyGrailDataUnqsName[ iHG ]         +'\n';
    }
    console.log( text );
}

function DumpRuneWordSorted( name, array )
{
    console.warn( '--- ' + name + ' ---\n' );

    var iRW, recipe, recipes = RECIPES.length, text = '';
    for( recipe = 0; recipe < recipes; recipe++ )
    {
        iRW = array[ recipe ];
        // ## [] S Name  Sock Type Lev Vers
        text += '#' + padLeft( recipe, 2 )
             + ' [' + padLeft( iRW, 2 )           + '] '
             +(gaRuneWordSuper[ iRW ] ? '*' : ' ') + ' '
             + gaRuneWordNames[ iRW ]              + ' '
             + gaRuneWordSocks[ iRW ]              + ' '
             + gaRuneWordType [ iRW ]              + ' '
             + gaRuneWordLevel[ iRW ]              + ' '
             + gaRuneWordVer  [ iRW ]              + '\n';
    }
    console.log( text );
}

// Convert string containing runes to array of rune numbers
function FindRunes( recipe )
{
    var runes = [], head = 0, end, len  = recipe.length, src, dst;

    while (head < len)
    {
        end = recipe.indexOf(' ',head); if (end < 0) end = len;
        src = recipe.substr( head, end-head );
        for( var rune = 0; rune < RUNES.length; rune++ )
        {
            dst = RUNES[rune].trim();
            if (src === dst)
                runes.push( rune );
        }
        head = recipe.indexOf('+',end); if (head < 0) break;
        head += 2;
    }

    return runes;
}

// array: arunes
// Find the minimum level given array of runes
function MinLevels( arunes )
{
    var min = 0;
    for( var rune = 0; rune < arunes.length; rune++ )
    {
        if (min < RUNE_LEVS[arunes[rune]])
            min = RUNE_LEVS[arunes[rune]];
    }
    return min;
}

// Verify runeword levels
function verify()
{
    var recipes = RECIPES.length;
    for( var recipe = 0; recipe < recipes; recipe++ )
    {
        var line     = RECIPES[recipe];

        var superior = line.substr( COLUMNS[0], COLUMNS[1]-COLUMNS[0] ).trim().length ? 1 : 0;
        var runeword = line.substr( COLUMNS[1], COLUMNS[2]-COLUMNS[1] ).trim();
        var sockets  = line.substr( COLUMNS[2], COLUMNS[3]-COLUMNS[2] ) | 0;
        var type     = line.substr( COLUMNS[3], COLUMNS[4]-COLUMNS[3] );
        var mats     = line.substr( COLUMNS[4], COLUMNS[5]-COLUMNS[4] );
        var level    = line.substr( COLUMNS[5], COLUMNS[6]-COLUMNS[5] ) | 0;
        var version  = line.substr( COLUMNS[6]                        );
        var arunes   = FindRunes( mats );

        if (sockets != arunes.length )
            console.error( "Number of sockets doesn't match number of runes!" );

        var expect   = MinLevels( arunes );
        if( level !== expect )
            console.error( "[" + recipe + "]: " + runeword + ", mats: " + mats + ", %o", arunes, "Expect Lev: " + expect + ", Actual Levl: " + level );
    }
}

function commaWrap( text, max )
{
    var result = text, sol = 0, next = 0, fits, width, lines = 1;

    // comma-wrap
    if (text.length > max)
    {
        result = '';
        lines  = 0;

        while (next >= 0)
        {
            fits = next;
            next = text.indexOf( ',', next );

            if (next < 0)
            {
                width = (text.length - sol);

                // Handle edge case of overflow on last line
                if (width >= max)
                {
                    result += text.substr( sol, fits-sol ) + '\n';
                    sol     = fits+1;
                    lines++;
                }

                result += text.substr( sol );
                lines++;
                break;
            }

            width = (next - sol);
            next++;

            if (width >= max)
            {
                result += text.substr( sol, fits-sol ) + '\n';
                sol     = fits+1;
                lines++;
            }
        }
    }

    if (lines < 2) result += '\n';
    if (lines < 3) result += '\n';
    if (lines < 4) result += '\n';

    return result;
}

function dataLoad()
{
    var temp;

    var runes = localStorage.getItem( 'availableRunes' );
    if (runes !== undefined && (typeof runes === 'string'))
    {
        gaAvailableRunes = JSON.parse( runes );

        var rune, runes = RUNES.length;
        for( rune = 0; rune < runes; rune++ )
        {
            setRuneVisibility( rune+1, gaAvailableRunes[ rune ] );
        }

        updateRunesRunewords();
    }

    var favs = localStorage.getItem( 'favoriteRuneWords' );
    if (favs !== undefined && (typeof favs === 'string'))
    {
        gaFavoriteRuneWords = JSON.parse( favs );
        var recipe, recipes = RECIPES.length;
        for( recipe = 0; recipe < recipes; recipe++ )
        {
            if( gaFavoriteRuneWords[ recipe ] )
                setFavoriteRuneWord( recipe, gaFavoriteRuneWords[ recipe ], false );
        }

        updateManifest();
    }

    var sets = localStorage.getItem( 'holygrailSets' );
    if (sets !== undefined && (typeof sets === 'string'))
    {
        temp = JSON.parse( sets );
        if (temp.length !== NUM_SETS)
        {
            console.error( "WARNING: Couldn't load Holy Grail saved Sets" );
        }
        else
            gaHolyGrailSets = temp;
    }

    var unqs = localStorage.getItem( 'holygrailUnqs' );
    if (unqs !== undefined && (typeof unqs === 'string'))
    {
        temp = JSON.parse( unqs );
        if (temp.length === (NUM_UNQS+1) ) // BUGFIX: Double Azurewrath due to faulty Holy Grail data
        {
            temp.splice( 289, 1 );
        }

        if (temp.length !== NUM_UNQS)
        {
            console.error( "WARNING: Couldn't load Holy Grail saved Uniques" );
        }
        else
            gaHolyGrailUnqs = temp;
    }

    updateHolyGrail();
}

function dataSave()
{
    localStorage.setItem( 'availableRunes'   , JSON.stringify( gaAvailableRunes    ) );
    localStorage.setItem( 'favoriteRuneWords', JSON.stringify( gaFavoriteRuneWords ) );
    localStorage.setItem( 'holygrailSets'    , JSON.stringify( gaHolyGrailSets     ) );
    localStorage.setItem( 'holygrailUnqs'    , JSON.stringify( gaHolyGrailUnqs     ) );
}

// Optional: width
// Optional: character to pad left with, such as '0'; will default to space
function padLeft( text, width, c )
{
    if( !width ) return "";
    if( !c ) c = ' ';
    return ("" + new Array( width ).join( c ) + text).slice( -width );
}

function initHolyGrailTables()
{
    var item, items = ITEMS.length, grail, cmp,
        nSets = 0, set_name,
        nUnqs = 0, unq_name;

    for( item = 0; item < items; item++ )
    {
        var line     = ITEMS[ item ],
            tc       = line.substr( HG_COLS[0], HG_COLS[1]-HG_COLS[0] - 1 ),
            name     = line.substr( HG_COLS[1], HG_COLS[2]-HG_COLS[1] - 1 ),
            set      = line.substr( HG_COLS[2], HG_COLS[3]-HG_COLS[2] - 1 ),
            unq      = line.substr( HG_COLS[3]                            );

//console.log( "" + tc + ", " + name + ", " + set + ", " + unq + "." );

        // Build unordered raw table
        gaHolyGrailDataBaseName.push( name );
        gaHolyGrailDataSetsName.push( set  );
        gaHolyGrailDataUnqsName.push( unq  );
        gaHolyGrailDataTC      .push( tc   );

        gaHolyGrailSortByBaseName.push( item );
        gaHolyGrailSortBySetsName.push( item );
        gaHolyGrailSortBySetsOwn .push( item );
        gaHolyGrailSortByUnqsName.push( item );
        gaHolyGrailSortByUnqsOwn .push( item );
        gaHolyGrailSortByTC      .push( item );

        set_name = set.trim();
        unq_name = unq.trim();

        if (set_name !== HG_EMPTY)
            gaHolyGrailMapRowToSets.push( nSets++ )
        else
            gaHolyGrailMapRowToSets.push( -1 );

        if (unq_name !== HG_EMPTY)
            gaHolyGrailMapRowToUnqs.push( nUnqs++ );
        else
            gaHolyGrailMapRowToUnqs.push( -1 );
    }

    // Build sorted table indices
    gaHolyGrailSortByBaseName.sort( (prev,next) =>
        {
            return gaHolyGrailDataBaseName[ prev ].localeCompare( gaHolyGrailDataBaseName[ next ] );
        }
    );

    gaHolyGrailSortBySetsName.sort( (prev,next) =>
        {
            var left  = gaHolyGrailDataSetsName[ prev ].trim();
            var right = gaHolyGrailDataSetsName[ next ].trim();

            if (left === HG_EMPTY)
            {
                if (right === HG_EMPTY)
                    return gaHolyGrailDataBaseName[ prev ].localeCompare( gaHolyGrailDataBaseName[ next ] );
                else
                    return +1; // Force '---' to be last
            }

            if (right === HG_EMPTY)
            {
                return -1;
            }

            cmp =  gaHolyGrailDataSetsName[ prev ].localeCompare( gaHolyGrailDataSetsName[ next ] ); if ( cmp ) return cmp;
            return gaHolyGrailDataBaseName[ prev ].localeCompare( gaHolyGrailDataBaseName[ next ] );
        }
    );

    gaHolyGrailSortByUnqsName.sort( (prev,next) =>
        {
            var left  = gaHolyGrailDataUnqsName[ prev ].trim();
            var right = gaHolyGrailDataUnqsName[ next ].trim();

            if (left === HG_EMPTY)
            {
                if (right === HG_EMPTY)
                    return gaHolyGrailDataBaseName[ prev ].localeCompare( gaHolyGrailDataBaseName[ next ] );
                else
                    return +1; // Force '---' to be last
            }

            if (right === HG_EMPTY)
            {
                    return -1;
            }

            cmp =  gaHolyGrailDataUnqsName[ prev ].localeCompare( gaHolyGrailDataUnqsName[ next ] ); if ( cmp ) return cmp;
            return gaHolyGrailDataBaseName[ prev ].localeCompare( gaHolyGrailDataBaseName[ next ] );
        }
    );

    gaHolyGrailSortByTC.sort( (prev,next) =>
        {
            cmp =  gaHolyGrailDataTC      [ prev ].localeCompare( gaHolyGrailDataTC      [ next ] ); if ( cmp ) return cmp;
            return gaHolyGrailDataBaseName[ prev ].localeCompare( gaHolyGrailDataBaseName[ next ] );
        }
    );

//    DumpHolyGrailSorted( "Name"   , gaHolyGrailSortByBaseName );
//    DumpHolyGrailSorted( "Set"    , gaHolyGrailSortBySetsName );
//    DumpHolyGrailSorted( "Set Own", gaHolyGrailSortBySetsOwn  );
//    DumpHolyGrailSorted( "Unq"    , gaHolyGrailSortByUnqsName );
//    DumpHolyGrailSorted( "Unq Own", gaHolyGrailSortByUnqsOwn  );
//    DumpHolyGrailSorted( "TC"     , gaHolyGrailSortByTC       );
}

function initTableCollapseBestFit()
{
    var div, divs = document.getElementsByTagName( 'div' ), ndivs = divs.length,
        dv, cs, parent, th, tr, tb, ta,
        rows, row, width = 0, minWidth;

    for( div = 0; div < ndivs; div++ )
    {
        dv = divs[div];
        cs = dv.getAttribute( 'class' );
        if (cs && cs.indexOf( 'bestfit' ) >= 0)
        {
            // For each row
            //    For each column
            //       Get max width
            th = dv.parentElement; // header
            tr = th.parentElement; // row
            tb = tr.parentElement; // body
            ta = tb.parentElement; // table
        }
    }
}

function initTableCollapseMinWidth()
{
    var div, divs = document.getElementsByTagName( 'div' ), ndivs = divs.length,
        dv, cs, parent, th, tr, tb, ta,
        rows, row, width = 0, minWidth;

    for( div = 0; div < ndivs; div++ )
    {
        dv = divs[div];
        cs = dv.getAttribute( 'class' );
        if (cs && cs.indexOf( 'collapse' ) >= 0)
        {
            th = dv.parentElement; // header
            tr = th.parentElement; // row
            tb = tr.parentElement; // body
            ta = tb.parentElement; // table

            // Can't used minWidth since it may not be set
            //     ta.style.width = ta.style.minWidth;
            minWidth = 0;
            rows = ta.getElementsByTagName( 'tr' );
            for( row = 0; row < rows.length; row++ )
            {
                width = parseInt( getComputedStyle( rows[row] ).width );
                if (width && (minWidth < width))
                    minWidth = width;
            }
            var px = (minWidth) + 'px';
            ta.style.width    = px;
            ta.style.minWidth = px;
        }
    }
}

function initRunewordTables()
{
    var recipe, recipes = RECIPES.length, cmp;

    for( recipe = 0; recipe < recipes; recipe++ )
    {
        var line     = RECIPES[recipe];

        var superior = line.substr( COLUMNS[0], 1                     ).trim().length ? 1 : 0;
        var runeword = line.substr( COLUMNS[1], COLUMNS[2]-COLUMNS[1] );
        var sockets  = line.substr( COLUMNS[2], 1                     ) | 0;
        var type     = line.substr( COLUMNS[3], COLUMNS[4]-COLUMNS[3] );
        var mats     = line.substr( COLUMNS[4], COLUMNS[5]-COLUMNS[4] );
        var level    = line.substr( COLUMNS[5], 2                     ) | 0;
        var version  = line.substr( COLUMNS[6]                        );
        var arunes   = FindRunes( mats );

        // Build unordered raw table
        gaRuneWordLevel.push( level    );
        gaRuneWordMats .push( mats     );
        gaRuneWordNames.push( runeword );
        gaRuneWordRunes.push( arunes   ); // element = array of runes
        gaRuneWordSocks.push( sockets  );
        gaRuneWordSuper.push( superior );
        gaRuneWordType .push( type     );
        gaRuneWordVer  .push( version  );

        // Build sorted table indices
        gaSortByLevel   .push( recipe );

        gaSortByMats1   .push( recipe );
        gaSortByMats2   .push( recipe );
        gaSortByMats3   .push( recipe );
        gaSortByMats4   .push( recipe );
        gaSortByMats5   .push( recipe );
        gaSortByMats6   .push( recipe );
        gaSortByNames   .push( recipe );
        gaSortByOwned   .push( recipe ); // dynamic
        gaSortBySockets .push( recipe );
        gaSortBySuperior.push( recipe );
        gaSortByType    .push( recipe );
        gaSortByVersion .push( recipe );
    }

    // Secondary sort by Name

    gaSortByLevel.sort( (prev,next) =>
        {
            if    (gaRuneWordLevel[ prev ] <              gaRuneWordLevel[ next ]) return -1;
            if    (gaRuneWordLevel[ prev ] >              gaRuneWordLevel[ next ]) return +1;
            return gaRuneWordNames[ prev ].localeCompare( gaRuneWordNames[ next ] );
        }
    );

    gaSortByNames.sort( (prev,next) =>
        {
            return gaRuneWordNames[ prev ].localeCompare( gaRuneWordNames[ next ] );
        }
    );

    //  0       8       16     23    29    35
    // "Dol   + Eld   + Hel  + Ist + Tir + Vex  "
    gaSortByMats1.sort( (prev,next) => { cmp = gaRuneWordMats[ prev ].substr( 0).localeCompare( gaRuneWordMats[ next ].substr( 0) );           return cmp;                                                                                            ; } );
    gaSortByMats2.sort( (prev,next) => { cmp = gaRuneWordMats[ prev ].substr( 8).localeCompare( gaRuneWordMats[ next ].substr( 8) ); if( cmp ) return cmp; return gaRuneWordMats[ prev ].substr( 0).localeCompare( gaRuneWordMats[ next ].substr( 0) ); } );
    gaSortByMats3.sort( (prev,next) => { cmp = gaRuneWordMats[ prev ].substr(16).localeCompare( gaRuneWordMats[ next ].substr(16) ); if( cmp ) return cmp; return gaRuneWordMats[ prev ].substr( 0).localeCompare( gaRuneWordMats[ next ].substr( 0) ); } );
    gaSortByMats4.sort( (prev,next) => { cmp = gaRuneWordMats[ prev ].substr(23).localeCompare( gaRuneWordMats[ next ].substr(23) ); if( cmp ) return cmp; return gaRuneWordMats[ prev ].substr( 0).localeCompare( gaRuneWordMats[ next ].substr( 0) ); } );
    gaSortByMats5.sort( (prev,next) => { cmp = gaRuneWordMats[ prev ].substr(29).localeCompare( gaRuneWordMats[ next ].substr(29) ); if( cmp ) return cmp; return gaRuneWordMats[ prev ].substr( 0).localeCompare( gaRuneWordMats[ next ].substr( 0) ); } );
    gaSortByMats6.sort( (prev,next) => { cmp = gaRuneWordMats[ prev ].substr(35).localeCompare( gaRuneWordMats[ next ].substr(35) ); if( cmp ) return cmp; return gaRuneWordMats[ prev ].substr( 0).localeCompare( gaRuneWordMats[ next ].substr( 0) ); } );

    gaSortBySockets.sort( (prev,next) =>
        {
            if    (gaRuneWordSocks[ prev ] <              gaRuneWordSocks[ next ]) return -1;
            if    (gaRuneWordSocks[ prev ] >              gaRuneWordSocks[ next ]) return +1;
            return gaRuneWordNames[ prev ].localeCompare( gaRuneWordNames[ next ] );
        }
    );

    gaSortBySuperior.sort( (prev,next) =>
        {
            if    (gaRuneWordSuper[ prev ] >              gaRuneWordSuper[ next ]) return -1; // intentional
            if    (gaRuneWordSuper[ prev ] <              gaRuneWordSuper[ next ]) return +1; // intentional
            return gaRuneWordNames[ prev ].localeCompare( gaRuneWordNames[ next ] );
        }
    );

    gaSortByType.sort( (prev,next) =>
        {
            var cmp = gaRuneWordType [ prev ].localeCompare( gaRuneWordType [ next ] ); if (cmp) return cmp;
            return    gaRuneWordNames[ prev ].localeCompare( gaRuneWordNames[ next ] );
        }
    );

    // gaSortByVersion -- nothing to do since sort by version is the default runeword table order

/*
    DumpRuneWordSorted( "Level"   , gaSortByLevel    );
    DumpRuneWordSorted( "Names"   , gaSortByNames    );
    DumpRuneWordSorted( "Sockets" , gaSortBySockets  );
    DumpRuneWordSorted( "Superior", gaSortBySuperior );
    DumpRuneWordSorted( "Type"    , gaSortByType     );
    DumpRuneWordSorted( "version" , gaSortByVersion  );
*/
}

/*
    https://stackoverflow.com/questions/6850164/get-the-device-width-in-javascript
*/
function getScreenSize()
{
    var resolutions =
    {
        '(min-width: 1200px)'                          : 'xl',
        '(min-width: 992px) and (max-width: 1199.98px)': 'lg',
        '(min-width: 768px) and (max-width: 991.98px)' : 'md',
        '(min-width: 576px) and (max-width: 767.98px)' : 'sm',
                               '(max-width: 575.98px)' : 'xs'
    };

    for (let size in resolutions)
        if (window.matchMedia(size).matches)
            return resolutions[size];

    return null;
}

function isTableSortColumnSelected( buttonName, className )
{
    var elem       = document.getElementById( buttonName );
    var css        = elem.getAttribute( 'class' );
    var isSelected = css.indexOf( className ) >= 0;
    return isSelected;
}

function onCollapse( button, table )
{
    button.collapsed = (!!!button.collapsed)|0;
    button.name = button.collapsed;

    if (table === undefined)
        table = button.value;

    setCollapseTable( table, button.collapsed, button );
}

function onCollapseAll( button )
{
    button.collapsed = (!!!button.collapsed)|0;
    button.textContent = COLLAPSE[ button.collapsed ];

    var ibutton, buttons = document.getElementsByTagName( 'button' ), nbuttons = buttons.length, buttonTableCollapse, buttonTableReference;

    for( ibutton = 0; ibutton < nbuttons; ibutton++ )
    {
        // Does this button refer to a table that can be collapsed?
        buttonTableCollapse  = buttons[ ibutton ];
        buttonTableReference = buttonTableCollapse.value;

        if ((buttonTableReference !== undefined) && buttonTableReference.length)
        {
            buttonTableCollapse.collapsed = button.collapsed;
            setCollapseTable( buttonTableReference, button.collapsed, buttonTableCollapse );
        }
    }
}

function onCollapseLoad()
{
}

function onCollapseSave()
{
}

function onColor( button )
{
    document.getElementById('content').style = '';

    if( !button.disabled )
    {
        button.disabled = true;
        document.getElementById( 'mono' ).disabled = false;
    }
}

function onLoad()
{
    onResize();

    // iOS touch / hover
    document.addEventListener("touchstart", function() {},false);

    gaAvailableRunes = new Array( RUNES.length );
    gaAvailableRunes.fill(1);
    initRunewordTables();

    gaRuneWordManifest = new Array( RUNES.length );
    gaRuneWordManifest.fill(0);

    gaFavoriteRuneWords = new Array( RECIPES.length );
    gaFavoriteRuneWords.fill(0);

    gaHolyGrailSets  = new Array( NUM_SETS );
    gaHolyGrailSets.fill(0);

    gaHolyGrailUnqs  = new Array( NUM_UNQS );
    gaHolyGrailUnqs.fill(0);
    initHolyGrailTables();

    dataLoad();

    var btn = document.getElementById( 'btn_collapse_sockitems' );
        btn.collapsed = true;

    // Sorting by Ladder really isn't useful any more
    onSortRuneWordsByOwned();

    initTableCollapseMinWidth();
    initTableCollapseBestFit();

    onSortHolyGrailBySetOwn();
}

function onMono( button )
{
    document.getElementById('content').style = 'filter:grayscale(100%);';

    if( !button.disabled )
    {
        button.disabled = true;
        document.getElementById( 'color' ).disabled = false;
    }
}

function onResize()
{
    var dim = getScreenSize();
    console.log( 'Dimension: ' + dim );
    var debug = document.getElementById( 'screen-size' );
    debug.innerText = dim;
}

function onSortHolyGrailByName   () { selectHolyGrailHeader( 'btnHolyGrailBaseName'  ); updateHolyGrailOrder    ( gaHolyGrailSortByBaseName  ) };
function onSortHolyGrailBySetName() { selectHolyGrailHeader( 'btnHolyGrailSetsName'  ); updateHolyGrailOrder    ( gaHolyGrailSortBySetsName  ) };
function onSortHolyGrailBySetOwn () { selectHolyGrailHeader( 'btnHolyGrailSetsOwned' ); updateHolyGrailSetsOwned( /* one off */              ) };
function onSortHolyGrailByUnqName() { selectHolyGrailHeader( 'btnHolyGrailUnqsName'  ); updateHolyGrailOrder    ( gaHolyGrailSortByUnqsName  ) };
function onSortHolyGrailByUnqOwn () { selectHolyGrailHeader( 'btnHolyGrailUnqsOwned' ); updateHolyGrailUnqsOwned( /* one off */              ) };
function onSortHolyGrailByTC     () { selectHolyGrailHeader( 'btnHolyGrailTC'        ); updateHolyGrailOrder    ( gaHolyGrailSortByTC        ) };

function onSortRuneWordsByLevel   () { selectRuneWordHeader( 'btnRuneWordLevel'    ); updateRuneWordsOrder( gaSortByLevel    ); }
function onSortRuneWordsByMats (mat) { selectRuneWordHeader( 'btnRuneWordMats'+mat ); updateRuneWordsOrder( gaRuneOrder[mat] ); }
function onSortRuneWordsByName    () { selectRuneWordHeader( 'btnRuneWordNames'    ); updateRuneWordsOrder( gaSortByNames    ); }
function onSortRuneWordsByOwned   () { selectRuneWordHeader( 'btnRuneWordOwned'    ); updateRuneWordsOwned( /* one off */    ); }
function onSortRuneWordsBySuperior() { selectRuneWordHeader( 'btnRuneWordSuperior' ); updateRuneWordsOrder( gaSortBySuperior ); }
function onSortRuneWordsBySocket  () { selectRuneWordHeader( 'btnRuneWordSockets'  ); updateRuneWordsOrder( gaSortBySockets  ); }
function onSortRuneWordsByType    () { selectRuneWordHeader( 'btnRuneWordType'     ); updateRuneWordsOrder( gaSortByType     ); }
function onSortRuneWordsByVersion () { selectRuneWordHeader( 'btnRuneWordVersion'  ); updateRuneWordsOrder( gaSortByVersion  ); }

function onToggleAllRunes( haveAll )
{
    var rune, runes = gaAvailableRunes.length;
    for( rune = 0; rune < runes; rune++ )
    {
        gaAvailableRunes[ rune ] = haveAll;
        setRuneVisibility( rune+1, haveAll );
    }

    dataSave();
    updateRunesRunewords();
}

function onToggleFavRW( btn )
{
    var recipe     = parseInt( btn.id.substr(3) ), // 'fav0' .. 'fav77'; was 'rw0' .. 'rw77'
        isFavorite = (btn.innerText.indexOf( FAVS[1] ) >= 0)|0;

    setFavoriteRuneWord( recipe, 1-isFavorite, true );
    updateManifest();
}

// On Toggle Holy Grail (Set/Unique)
function onToggleHG( button )
{
    updateHolyGrailButton( button, 1 );
    dataSave();
    updateHolyGrailTotals();

    // Toggling ownership of set item needs to update the table order if user is sorted by Sets Owned
    if( isTableSortColumnSelected( 'btnHolyGrailSetsOwned', 'hge' ) )
        updateHolyGrailSetsOwned();

    if( isTableSortColumnSelected( 'btnHolyGrailUnqsOwned','hge' ) )
        updateHolyGrailUnqsOwned();
}

// Toggle owning a rune
function onToggleRune( index )
{
    var rune = index-1;
    gaAvailableRunes[ rune ] ^= 1;
    setRuneVisibility( index, gaAvailableRunes[ rune ] );

    dataSave();
    updateRunesRunewords();
}

// Runeword table row or Rune image
function setElementVisible( elem, vis )
{
    if   ( vis ) { elem.style.filter = ''               ; }
    else         { elem.style.filter = 'brightness(50%)'; }

}

function setCollapseTable( tableName, isCollapsed, button )
{
    var table = document.getElementById( tableName ),
        rows  = table.getElementsByTagName( 'tr' ),
        row   = 1; // getButtonRow( tableName, button );

    button.textContent = FACE[ isCollapsed ];

    for( ; row < rows.length; row++ )
    {
        if( isCollapsed ) rows[row].classList.add   ( 'collapsed' );
        else              rows[row].classList.remove( 'collapsed' );
    }
}

// Update button state
// NOTE: need to call updateManifest() after
function setFavoriteRuneWord( recipe, isFavorite, updateLocalStorage )
{
    var btn = document.getElementById( 'fav' + recipe );
        btn.innerText = FAVS[ isFavorite ];
    gaFavoriteRuneWords[ recipe ] = isFavorite;

    var r, rune, runes = gaRuneWordRunes[ recipe ],
        delta = (isFavorite) ? +1 : -1;

    // Add/Sub runes to manifest
    for( rune = 0; rune < runes.length; rune++ )
    {
        r = runes[ rune ];
        gaRuneWordManifest[ r ] = gaRuneWordManifest[ r ] + delta;
    }

    if( updateLocalStorage )
        dataSave();
}

function selectHolyGrailHeader( selected )
{
    const c = 'class',
          d = 'hgd'  , // Disable
          e = 'hge'  ; // Enable
    var   elem;

    elem = document.getElementById( 'btnHolyGrailBaseName'  ); elem.removeAttribute( e ); elem.setAttribute( c, d );
    elem = document.getElementById( 'btnHolyGrailSetsName'  ); elem.removeAttribute( e ); elem.setAttribute( c, d );
    elem = document.getElementById( 'btnHolyGrailSetsOwned' ); elem.removeAttribute( e ); elem.setAttribute( c, d );
    elem = document.getElementById( 'btnHolyGrailUnqsName'  ); elem.removeAttribute( e ); elem.setAttribute( c, d );
    elem = document.getElementById( 'btnHolyGrailUnqsOwned' ); elem.removeAttribute( e ); elem.setAttribute( c, d );
    elem = document.getElementById( 'btnHolyGrailTC'        ); elem.removeAttribute( e ); elem.setAttribute( c, d );

    elem = document.getElementById( selected );
    elem.removeAttribute( d );
    elem.setAttribute( c, e );
}


function setRuneVisibility( rune, owned )
{
    var rune2    = document.getElementById( 'r' + rune );                setElementVisible( rune2   , owned );
    var upgrade2 = document.getElementById( 'u' + rune ); if( upgrade2 ) setElementVisible( upgrade2, owned );

    var rune1    = document.getElementById( 's' + rune );                setElementVisible( rune1   , owned );
    var upgrade1 = document.getElementById( 'v' + rune ); if( upgrade1 ) setElementVisible( upgrade1, owned );
}

function selectRuneWordHeader( selected )
{
    var c = 'class',
        d = 'rwu'  , // Disable
        e = 'rws'  , // Enable
        elem;

    elem = document.getElementById( 'btnRuneWordSuperior' ); elem.removeAttribute( e ); elem.setAttribute( c, d );
    elem = document.getElementById( 'btnRuneWordMats1'    ); elem.removeAttribute( e ); elem.setAttribute( c, d );
    elem = document.getElementById( 'btnRuneWordMats2'    ); elem.removeAttribute( e ); elem.setAttribute( c, d );
    elem = document.getElementById( 'btnRuneWordMats3'    ); elem.removeAttribute( e ); elem.setAttribute( c, d );
    elem = document.getElementById( 'btnRuneWordMats4'    ); elem.removeAttribute( e ); elem.setAttribute( c, d );
    elem = document.getElementById( 'btnRuneWordMats5'    ); elem.removeAttribute( e ); elem.setAttribute( c, d );
    elem = document.getElementById( 'btnRuneWordMats6'    ); elem.removeAttribute( e ); elem.setAttribute( c, d );
    elem = document.getElementById( 'btnRuneWordNames'    ); elem.removeAttribute( e ); elem.setAttribute( c, d );
    elem = document.getElementById( 'btnRuneWordOwned'    ); elem.removeAttribute( e ); elem.setAttribute( c, d );
    elem = document.getElementById( 'btnRuneWordSockets'  ); elem.removeAttribute( e ); elem.setAttribute( c, d );
    elem = document.getElementById( 'btnRuneWordType'     ); elem.removeAttribute( e ); elem.setAttribute( c, d );
    elem = document.getElementById( 'btnRuneWordLevel'    ); elem.removeAttribute( e ); elem.setAttribute( c, d );
    elem = document.getElementById( 'btnRuneWordVersion'  ); elem.removeAttribute( e ); elem.setAttribute( c, d );

    elem = document.getElementById( selected );
    elem.removeAttribute( d );
    elem.setAttribute( c, e );
}

    // Inspired from: https://gist.github.com/danprince/05cb72052484355f3adc
    function _addClasses( elem, classnames )
    {
        var userClasses = classnames.split( ' ' );
        if( userClasses.length )
            userClasses.forEach( classname =>
                {
                    var classes = elem.getAttribute( 'class' ).split( ' ' );
                    var offset  = classes.indexOf( classname );
                    if (offset < 0)
                    {
                        classes.push( classname );
                        elem.setAttribute( 'class', classes.join( ' ' ) );
                    }
                }
            );
    }

    // Inspired from: https://gist.github.com/danprince/05cb72052484355f3adc
    function _removeClasses( elem, classnames )
    {
        var userClasses = classnames.split( ' ' );
        if( userClasses.length )
            userClasses.forEach( classname =>
                {
                    var classes = elem.getAttribute( 'class' ).split( ' ' );
                    var offset  = classes.indexOf( classname );
                    if (offset >= 0)
                        classes.splice( offset, 1 );
                    elem.setAttribute( 'class', classes.join( ' ' ) );
                }
            );
    }

function updateHolyGrail()
{
    var button, iSet, iUnq;

    // Update all button states
    for( iSet = 0; iSet < NUM_SETS; iSet++ )
    {
        button = document.getElementById( 'hgs.' + padLeft( iSet, 3, '0' ) );
        updateHolyGrailButton( button, 0 );
    }

    for( iUnq = 0; iUnq < NUM_UNQS; iUnq++ )
    {
        button = document.getElementById( 'hgu.' + padLeft( iUnq, 3, '0' ) );
        updateHolyGrailButton( button, 0 );
    }

    updateHolyGrailTotals();
}

function updateHolyGrailButton( button, isToggle )
{
    var isSet = button.id.indexOf( 'hgs' ) >= 0,
        index = parseInt( button.id.substr( 4 ) ),
        state = -1;

    if (isSet && (index < NUM_SETS))
        state = gaHolyGrailSets[ index ] = (gaHolyGrailSets[ index ] ^ isToggle);
    else
        if (index < NUM_UNQS)
            state = gaHolyGrailUnqs[ index ] = (gaHolyGrailUnqs[ index ] ^ isToggle);

    var colorize =
    [
        "mis", // Missing = red
        "own", // OWned   = green
    ];

    if (state >= 0)
    {
        button.textContent = FAVS[ state ];

        _removeClasses( button, 'mis own' );
        _addClasses( button, colorize[ state ] );
    }
}

function updateHolyGrailOrder( array )
{
    var table = document.getElementById( 'table.treasureclass' ),
        rows  = table.getElementsByTagName( 'tr' ),
        row   = 0,
        src;

    // Reorder
    for( row = 1; row < rows.length; row++ )
    {
        src = document.getElementById( 'hg' + array[ row-1] );
        rows[row].parentNode.insertBefore( src, rows[row].nextSibling );
    }

    // Recolorize even/odd rows
    for( row = 1; row < rows.length; row++ )
    {
        var tr    = rows[ row ];
        _removeClasses( tr, 'r11 r22 g11 g22 b11 b22 k11 k22 y44' );

        var isOdd = (row & 1); // don't include header row
        _addClasses( tr, isOdd ? 'b11' : 'b22' );
    }
}

function updateHolyGrailSetsOwned()
{
    gaHolyGrailSortBySetsOwn.sort( (prev,next) =>
        {
            var left  = gaHolyGrailDataSetsName[ prev ].trim();
            var right = gaHolyGrailDataSetsName[ next ].trim();

            var iSetL = gaHolyGrailMapRowToSets[ prev ]; // -1 row has no set; > 0 id of hgs.#
            var iSetR = gaHolyGrailMapRowToSets[ next ]; // -1 row has no set; > 0 id of hgs.#

            var ownedL = (iSetL >= 0) ? gaHolyGrailSets[ iSetL ] : 0;
            var ownedR = (iSetR >= 0) ? gaHolyGrailSets[ iSetR ] : 0;

            // 1. Force '---' to be very last
            if (left === HG_EMPTY)
            {
                if (right === HG_EMPTY)
                    return gaHolyGrailDataBaseName[ prev ].localeCompare( gaHolyGrailDataBaseName[ next ] );
                else
                    return +1;
            }

            if (right === HG_EMPTY)
            {
                    return -1;
            }

            // 2. Prioritize unowned items to be first over owned items
            if (!ownedL && ownedR )
                return -1;

            if ( ownedL && !ownedR )
                return + 1;

            // 3. Sort by name
            //         ownedL == ownedR == FALSE
            //      OR ownedL == ownedR == TRUE
            //    In either case sort by the set name
            return gaHolyGrailDataSetsName[ prev ].localeCompare( gaHolyGrailDataSetsName[ next ] );
        }
    );

    updateHolyGrailOrder( gaHolyGrailSortBySetsOwn );
}

function updateHolyGrailTotals()
{
    var i,
        totalSets = 0, totalUnqs = 0, totalHoly,
        ownedSets    , ownedUnqs    , ownedHoly,

        elemSetsNum, elemSetsPercent,
        elemUnqsNum, elemUnqsPercent,
        elemHolyNum, elemHolyPercent;

    for( i = 0; i < NUM_SETS; i++ )
        totalSets += gaHolyGrailSets[i];

    for( i = 0; i < NUM_UNQS; i++ )
        totalUnqs += gaHolyGrailUnqs[i]

    totalHoly = totalSets + totalUnqs;

    // round 2 digit places
    ownedSets = ((10000 * totalSets) / NUM_SETS ) | 0; ownedSets /= 100;
    ownedUnqs = ((10000 * totalUnqs) / NUM_UNQS ) | 0; ownedUnqs /= 100;
    ownedHoly = ((10000 * totalHoly) / NUM_HOLY ) | 0; ownedHoly /= 100;

    elemSetsNum = document.getElementById( 'manifest.hgs' ); elemSetsPercent = document.getElementById( 'manifest.hgsp' );
    elemUnqsNum = document.getElementById( 'manifest.hgu' ); elemUnqsPercent = document.getElementById( 'manifest.hgup' );
    elemHolyNum = document.getElementById( 'manifest.hgt' ); elemHolyPercent = document.getElementById( 'manifest.hgtp' );

    elemSetsNum.innerText = "" + totalSets;
    elemUnqsNum.innerText = "" + totalUnqs;
    elemHolyNum.innerText = "" + totalHoly;

    elemSetsPercent.innerText = "" + ownedSets.toLocaleString();
    elemUnqsPercent.innerText = "" + ownedUnqs.toLocaleString();
    elemHolyPercent.innerText = "" + ownedHoly.toLocaleString();
}

function updateHolyGrailUnqsOwned()
{
    gaHolyGrailSortByUnqsOwn.sort( (prev,next) =>
        {
            var left  = gaHolyGrailDataUnqsName[ prev ].trim();
            var right = gaHolyGrailDataUnqsName[ next ].trim();

            var iUnqL = gaHolyGrailMapRowToUnqs[ prev ]; // -1 row has no unique; > 0 id of hgu.#
            var iUnqR = gaHolyGrailMapRowToUnqs[ next ]; // -1 row has no unique; > 0 id of hgu.#

            var ownedL = (iUnqL >= 0) ? gaHolyGrailUnqs[ iUnqL ] : 0;
            var ownedR = (iUnqR >= 0) ? gaHolyGrailUnqs[ iUnqR ] : 0;

            // 1. Force '---' to be very last
            if (left === HG_EMPTY)
            {
                if (right === HG_EMPTY)
                    return gaHolyGrailDataBaseName[ prev ].localeCompare( gaHolyGrailDataBaseName[ next ] );
                else
                    return +1;
            }

            if (right === HG_EMPTY)
            {
                    return -1;
            }

            // 2. Prioritize unowned items to be first over owned items
            if (!ownedL && ownedR )
                return -1;

            if ( ownedL && !ownedR )
                return + 1;

            // 3. Sort by name
            //         ownedL == ownedR == FALSE
            //      OR ownedL == ownedR == TRUE
            //    In either case sort by the unique name
            return gaHolyGrailDataUnqsName[ prev ].localeCompare( gaHolyGrailDataUnqsName[ next ] );
        }
    );

    updateHolyGrailOrder( gaHolyGrailSortByUnqsOwn );
}

function updateManifest()
{
    var i, r, rune, runes, txt = '', work, manifest = document.getElementById( 'manifest' );

    // Update manifest
    for( i = 0; i < gaRuneWordManifest.length; i++ )
    {
        rune = SORTED[ i ]; // Sort manifest alphabetically by runes
        r = gaRuneWordManifest[ rune ];
        if( r )
            txt += '' + gaRuneWordManifest[ rune ] + 'x ' + RUNES[ rune ].trim() + ', ';
    }

    // if manifest > 100 chars word wrap
    txt   = txt.substr( 0, txt.length - 2 ); // Trim last comma
    manifest.innerText = commaWrap( txt, 100 );
}

function updateRunesRunewords()
{
    updateRuneHeaderStatus();
    updateRuneWordsOwned();
    updateRuneWordsVisible();
}

function updateRuneHeaderStatus()
{
    var c = 'class',
        d = 'unsel',
        e = 'sel',
        elem,
        total    = gaAvailableRunes.reduce( (elem1,elem2) => elem1 + elem2, 0 ),
        haveAll  = (total === RUNES.length)|0,
        haveNone = (total === 0);

    if (haveAll || haveNone)
    {
        elem = document.getElementById( 'xl_RunesSelect' +    haveAll ); elem.removeAttribute( d ); elem.setAttribute( c, e ); // Selected "None" or "All"
        elem = document.getElementById( 'xl_RunesSelect' + (1-haveAll)); elem.removeAttribute( e ); elem.setAttribute( c, d ); // Other

        elem = document.getElementById( 'md_RunesSelect' +    haveAll ); elem.removeAttribute( d ); elem.setAttribute( c, e ); // Selected "None" or "All"
        elem = document.getElementById( 'md_RunesSelect' + (1-haveAll)); elem.removeAttribute( e ); elem.setAttribute( c, d ); // Other
    }
    else
    {
        // Reselect "None" if no runes are owned
        // Reselect "All"  if all runes are owned
        var nonecss = total                   ? 'unsel' : 'sel';
        var allcss  = (total != RUNES.length) ? 'unsel' : 'sel';

        elem = document.getElementById( 'xl_RunesSelect0' ); elem.removeAttribute( e ); elem.setAttribute( c, nonecss ); // None
        elem = document.getElementById( 'xl_RunesSelect1' ); elem.removeAttribute( e ); elem.setAttribute( c, allcss  ); // All

        elem = document.getElementById( 'md_RunesSelect0' ); elem.removeAttribute( e ); elem.setAttribute( c, nonecss ); // None
        elem = document.getElementById( 'md_RunesSelect1' ); elem.removeAttribute( e ); elem.setAttribute( c, allcss  ); // All
    }
}

function updateRuneWordsOrder( array )
{
    var table = document.getElementById( 'table.runeWords' ),
        rows  = table.getElementsByTagName( 'tr' ),
        row   = 0,
        src;

    // Reorder
    for( row = 1; row < rows.length; row++ )
    {
        src = document.getElementById( 'rw' + array[ row-1] );
        rows[row].parentNode.insertBefore( src, rows[row].nextSibling );
    }

    // Recolorize even/odd rows
    for( row = 1; row < rows.length; row++ )
    {
        var tr    = rows[ row ];
        var elem  = tr.firstChild;      // <td>
        //  elem.getAttributeNames();   // class
        //  elem.getAttribute('class'); // 'tooltip g11'
            _removeClasses( elem, 'r11 r22 g11 g22 b11 b22 k11 k22 y44' );


        var isOdd = (row & 1); // don't include header row
        var ver   = gaRuneWordVer[ array[ row-1 ] ];
        var is109 = ver.indexOf( '1.09'     ) === 0; // r
        var is110 = ver.indexOf( '1.10'     ) === 0; // g
        var isLad = ver.indexOf( '1.10 lad' ) === 0; // b
        var is111 = ver.indexOf( '1.11'     ) === 0; // k


             if( is111 ) _addClasses( elem, isOdd ? 'k11' : 'k22' );
        else if( isLad ) _addClasses( elem, isOdd ? 'b11' : 'b22' );
        else if( is110 ) _addClasses( elem, isOdd ? 'g11' : 'g22' );
        else             _addClasses( elem, isOdd ? 'r11' : 'r22' );
    }
}

function updateRuneWordsOwned()
{
    // Update owned runeword array
    gaSortByOwned.sort( (prev,next) =>
        {
            var runes1 = gaRuneWordRunes[ prev ];
            var runes2 = gaRuneWordRunes[ next ];

            var total1 = 0; runes1.forEach( rune => total1 += gaAvailableRunes[ rune ] );
            var total2 = 0; runes2.forEach( rune => total2 += gaAvailableRunes[ rune ] );

            var haveRunes1 = (total1 === runes1.length);
            var haveRunes2 = (total2 === runes2.length);

            if (haveRunes1 > haveRunes2) return -1; // Owning all runes in runeword1 higher priority
            if (haveRunes1 < haveRunes2) return +1; // Owning all runes in runeword2 higher priority
            return gaRuneWordNames[ prev ].localeCompare( gaRuneWordNames[ next ] );
        }
    );

    if( isTableSortColumnSelected( 'btnRuneWordOwned', 'rws' ) );
        updateRuneWordsOrder( gaSortByOwned );
}

function updateRuneWordsVisible()
{
    var rw, rune, runes, tr, seen;

    for( rw = 0; rw < gaRuneWordRunes.length; rw++ )
    {
        tr    = document.getElementById( 'rw' + rw );
        runes = gaRuneWordRunes[rw];
        seen  = 1;

        for( rune = 0; rune < runes.length; rune++ )
        {
            if( !gaAvailableRunes[ runes[ rune ] ] )
            {
                seen = 0;
                break;
            }
        }

        setElementVisible( tr, seen );
    }
}
        </script>
    </head>
<body onload='onLoad();' onresize='onResize();'><div id='content'>
<table class='head'>
    <tr>
        <td class='vatop column1'>
            <span style='font-size:18px;'><i>Diablo 2</i> <a href='https://github.com/Michaelangel007/d2_cheat_sheet'>Cheat Sheet</a></span>
            <span style='font-size:14px;'> by <i>Michaelangel007</i></span> <img alt='m007' src='pics/m007.png'> <i><a href='https://www.reddit.com/user/MysticReddit'>/u/MysticReddit</a></i>
<button type='button' id='mono'                  onclick='onMono(this)       ;'>Mono</button>
<button type='button' id='color'        disabled onclick='onColor(this)      ;'>Color</button>
<button type='button' id='collapse_all'          onclick='onCollapseAll(this);'>Collapse</button>
            <br>
            <br>
            <table class='head' style='min-width:730px' id='table.fcr'>
<tr class='bt bb'        ><th><span class='b'>Faster Cast Rate (<span class='fcr'>FCR</span>)</span>                             <a href='https://www.youtube.com/watch?v=ivm5cFeJYSA'>Hidden</a> 86 <a href='https://www.diabloii.net/forums/threads/druid-fcr-action-frames-good-info-for-pvp-elementalists-i.794229/'>breakpoint</a> *<div class='collapse'><button value='table.fcr' onclick='onCollapse(this);'>-</button></div>
<meta                       />Frames  23  22  21  20  19  18  17  16  15   14   13   12   11   10    9    8    7</th></tr>
<tr><td class='tooltip k11'  >Ama                      0   7  14  22  32   48   68   99  152                    </td></tr>
<tr><td class='tooltip r22'  >Asn                                  0   8   16   27   42   65  102  174          </td></tr>
<tr><td class='tooltip k11'  >Bar                                                0    9   20   37   63  105  200</td></tr>
<tr><td class='tooltip g22'  >Drd Human                    0   4  10  19   30   46   68   99  163               </td></tr>
<tr><td class='tooltip k11'  >    Bear                             0   7   15   26   40   63   99  163          </td></tr>
<tr><td class='tooltip g22'  >    Wolf                             0   6   14   26   40   60   95  157          </td></tr>
<tr><td class='tooltip k11'  >Nec Human                                0    9   18   30   48   75  125          </td></tr>
<tr><td class='tooltip k22'  >    Vamp 0   6  11  18  24  35  48  65  86  120  180                              </td></tr>
<tr><td class='tooltip k11'  >Pal                                      0    9   18   30   48   75  125          </td></tr>
<tr><td class='tooltip b22'  >Src Lightning            0   7  15  23  35   52   78  117  194                    </td></tr>
<tr><td class='tooltip k11'  >    Other skills                                   0    9   20   37   63<span class='note'>*</span> 105  200</td></tr>
<tr><td class='tooltip k22'  >Mrc Act3                         0   8  15   26   39   58   86  138               </td></tr>
<tr class='bt'           ><th>Frames  23  22  21  20  19  18  17  16  15   14   13   12   11   10    9    8    7</th></tr>
            </table>
            <br>
            <table class='head column2' id='table.fhr'>
<tr class='gt gb'        ><th><span class='g'>Faster Hit Recovery (<span class='fhr'>FHR</span>)</span><div class='collapse'><button value='table.fhr' onclick='onCollapse(this);'>-</button></div>
<meta                       />Frames   17  16  15  14  13  12  11  10   9   8    7    6    5    4    3    2    1</th></tr>
<tr><td class='tooltip k11'  >Ama                               0   6  13  20   32   52   86  174  600          </td></tr>
<tr><td class='tooltip r22'  >Asn                                       0   7   15   27   48   86  200          </td></tr>
<tr><td class='tooltip k11'  >Bar                                       0   7   15   27   48   86  200          </td></tr>
<tr><td class='tooltip g22'  >Drd Human 1H          0   3   7  13  19  29  42   63   99  174  456               </td></tr>
<tr><td class='tooltip k11'  >    Human 2H              0   5  10  16  26  39   56   86  152  377               </td></tr>
<tr><td class='tooltip g22'  >    Bear                  0   5  10  16  24  37   54   86  152  460               </td></tr>
<tr><td class='tooltip k11'  >    Wolf                                           0    9   20   42   86  280     </td></tr>
<tr><td class='tooltip k22'  >Nec Human                 0   5  10  16  26  39   56   86  152  377               </td></tr>
<tr><td class='tooltip k11'  >    Vamp          0   2   6  10  16  24  34  48   72  117                         </td></tr>
<tr><td class='tooltip k22'  >Pal Spear/Stave           0   3   7  13  20  32   48   75  129  280               </td></tr>
<tr><td class='tooltip k11'  >    rest                                  0   7   15   27   48   86  200          </td></tr>
<tr><td class='tooltip b22'  >Src               0   5   9  14  20  30  42  60   86  142  280                    </td></tr>
<tr><td class='tooltip k11'  >Mrc Act1                          0   6  13  20   32   52   86  174  600          </td></tr>
<tr><td class='tooltip k22'  >    Act2          0   5   9  14  20  30  42  60   86  142  280                    </td></tr>
<tr><td class='tooltip k11'  >    Act3  0   5   8  13  18  24  32  46  63  86  133  232  600                    </td></tr>
<tr><td class='tooltip k22'  >    Act5                                  0   7   15   27   48   86  200          </td></tr>
<tr class='gt'           ><th>Frames   17  16  15  14  13  12  11  10   9   8    7    6    5    4    3    2    1</th></tr>
            </table>
            <br>
            <table class='head column2' id='table.fbr'>
<tr class='rt rb'        ><th><span class='r'>Faster Block Rate (<span class='fbr'>FBR</span>)</span>           Block% = (Shield% * (Dex - 15)) / (clvl * 2)<div class='collapse'><button value='table.fbr' onclick='onCollapse(this);'>-</button></div>
<meta                       />Frames   17  16  15  14  13  12  11  10   9   8    7    6    5    4    3    2    1</th></tr>
<tr><td class='tooltip k22'  >Ama 1H*   0   4   6  11  15  23  29  40  56  80  120  200  480                    <span class='tool ttr'><b>Includes:</b><br><br> 1H axes and throwing axes,<br> clubs,<br> 1H maces, <br> orbs,<br> scepters, <br> 1H swords, 2H swords wielded in one hand,<br> and wands.</span></td></tr>
<tr><td class='tooltip k11'  >    2H                                                       0   13   32   86  600</td></tr>
<tr><td class='tooltip r22'  >Asn                                                          0   13   32   86  600</td></tr>
<tr><td class='tooltip k11'  >Bar                                                0    9   20   42   86  280     </td></tr>
<tr><td class='tooltip g22'  >Drd Human                         0   6  13  20   32   52   86  174  600          </td></tr>
<tr><td class='tooltip g11'  >    Bear                                  0   7   15   27   48   86  200          </td></tr>
<tr><td class='tooltip k22'  >    Wolf                  0   5  10  16  27  40   65  109  223                    </td></tr>
<tr><td class='tooltip k11'  >Nec Human                         0   6  13  20   32   52   86  174  600          </td></tr>
<tr><td class='tooltip k22'  >    Vamp          0   2   6  10  16  24  34  48   72  117  208                    </td></tr>
<tr><td class='tooltip k11'  >Pal                                                          0   13   32   86  600</td></tr>
<tr><td class='tooltip k22'  >    Holy Shield                                                             0   86</td></tr>
<tr><td class='tooltip b22'  >Src                                       0   7   15   27   48   86  200          </td></tr>
<tr class='rt'           ><th>Frames   17  16  15  14  13  12  11  10   9   8    7    6    5    4    3    2    1</th></tr>
            </table>
<br>

<table class='head' id='table.reroll'>
    <tr class='rt rb'><th><a href='http://classic.battle.net/diablo2exp/items/cube.shtml'><span class='r'>Rerolling Magic/Rare Items</span></a><div class='collapse'><button value='table.reroll' onclick='onCollapse(this);'>-</button></div></th></tr>
    <tr><td class='tooltip k11'>3 Perfect Gems + <span class='magic'>Magic</span> Item &rarr; New Random <span class='magic'>Magic</span> Item of the same type (<span class='magic'>Grand Charms</span>)           <span class='tool ttr'>Skillers ilvl 50,<br><br>Skillers with +(41-45) Life ilvl 94<br><b>Hell</b> Baal, Diablo, Nihlathak</span></td></tr>
    <tr><td class='tooltip k22'>6 Perfect Skulls + Rare Item &rarr; Random Low Quality Rare Item of the same type (<span class='rare'>Diadems</span>)        </td></tr>
</table>
<br>
<table class='head' id='table.sockcube'>
    <tr class='gt gb'><th><span class='g'>Socketing (with Act 5 <a href='https://diablo2.diablowiki.net/Siege_on_Harrogath'>Larzuk</a>, <a href='http://classic.battle.net/diablo2exp/items/cube.shtml'>Cube</a>, or Ebug)</span><div class='collapse'><button value='table.sockcube' onclick='onCollapse(this);'>-</button></div></th></tr>
    <tr><td class='tooltip k11'>Normal drops = max 3<span class='note'>*</span> sockets      (<span class='note'>*Cows</span> = 4 socket, <span class='note'>Larzuk</span> # sockets = ilvl &larr; mlvl &larr; alvl)</td></tr>
    <tr><td class='tooltip k22'> nm    drops = max 4 sockets       (<span class='mf'>0</span> MF is best for finding bases)                           </td></tr>
    <tr><td class='tooltip k11'>Hell   drops = max 6 sockets                                                                  </td></tr>
    <tr><td class='tooltip k22'>Larzuk = max 1 socket to uniques, 1-6 sockets to white bases depending on ilvl and type       </td></tr>
    <tr><td class='tooltip k11'>Tal + Thul + Perfect Topaz    + Normal Body Armor &rarr; Socketed Body Armor of same type          <span class='tool ttk'><span class='in'>Tal </span><img src='runes/tal.png'  /><span class='in'> + Thul </span><img src='runes/thul.png' /><span class='in'> + </span><img src='gems/topaz_perfect.png'   ></span></td></tr>
    <tr><td class='tooltip k22'>Ral + Amn  + Perfect Amethyst + Normal Weapon     &rarr; Socketed Weapon     of same type          <span class='tool ttk'><span class='in'>Ral </span><img src='runes/ral.png'  /><span class='in'> + Amn  </span><img src='runes/amn.png'  /><span class='in'> + </span><img src='gems/amethyst_perfect.png'></span></td></tr>
    <tr><td class='tooltip k11'>Ral + Thul + Perfect Sapphire + Normal Helm       &rarr; Socketed Helm       of same type          <span class='tool ttk'><span class='in'>Ral </span><img src='runes/ral.png'  /><span class='in'> + Thul </span><img src='runes/thul.png' /><span class='in'> + </span><img src='gems/sapphire_perfect.png'></span></td></tr>
    <tr><td class='tooltip k22'>Tal + Amn  + Perfect Ruby     + Normal Shield     &rarr; Socketed Shield     of same type          <span class='tool ttk'><span class='in'>Tal </span><img src='runes/tal.png'  /><span class='in'> + Amn  </span><img src='runes/amn.png'  /><span class='in'> + </span><img src='gems/ruby_perfect.png'    ></span></td></tr>
    <tr><td class='tooltip k11'>Hel + Scroll of Town Portal   + Any Socketed Item &rarr; Remove gems, runes, or jewels from sockets<span class='tool ttk'><span class='in'>Hel </span><img src='runes/hel.png'  /><span class='in'> + </span><img src='pics/scroll_town_portal.png'/></span                                 ></td></tr>
</table>
<br>
<table class='head' id='table.repair'>
    <tr class='bt bb'      ><th><span class='b'>Repair</span> (<b>Note:</b> <span class='note'>You cannot repair Ethereal items</span>)<div class='collapse'><button value='table.repair' onclick='onCollapse(this);'>-</button></div></th></tr>
    <tr><td class='tooltip k11'>Ort Rune + Weapon               &rarr; Fully Repaired Weapon                                       <span class='tool ttk'><span class='in'>Ort </span><img src='runes/ort.png'  /></span></td></tr>
    <tr><td class='tooltip k11'>Ral Rune + Armor                &rarr; Fully Repaired Armor                                        <span class='tool ttk'><span class='in'>Ral </span><img src='runes/ral.png'  /></span></td></tr>
    <tr><td class='tooltip y22'>Ort Rune + Chipped Gem + Weapon &rarr; Fully Repaired and Recharged Weapon                         <span class='tool ttk'><span class='in'>Ort </span><img src='runes/ort.png'  /><span class='in'> + Chipped gem (any type)</span><br><br>(Usefull for recharging <b>Teleport</b>) staff</span></td><tr>
    <tr><td class='tooltip y11'>Ral Rune + Flawed Gem  + Armor  &rarr; Fully Repaired and Recharged Armor                          <span class='tool ttk'><span class='in'>Ral </span><img src='runes/ral.png'  /><span class='in'> + Flawed gem (any type)</span></td</tr>
</table>
<br>
<table class='head' id='table.misccube'>
    <tr class='rt rb'><th      >Misc. Cube<div class='collapse'><button value='table.misccube' onclick='onCollapse(this);'>-</button></div></th></tr>
    <tr><td class='tooltip r11'>3x Rejuvenation Potions       &rarr; Full Rejuvenation Potion   <span class='tool ttk'><img class='rejuvs'/><span class='in'> + </span><img class='rejuvs'/><span class='in'> + </span><img class='rejuvs'/><span class='in'> &rarr; </span><img class='rejuvf'/></span></td></tr>
    <tr><td class='tooltip r22'>Staff + Kris + Belt + Diamond &rarr; Savage Polearm Class Weapon<span class='tool ttk'><span class='note'>66-80% Enhanced Damage</span><br><br>Weapon Type one of:<br><br>Bardiche,<br>Battle Scythe,<br>Bill,<br>Halbred,<br>Lochaber Axe,<br>Partizan,<br>Poleaxe,<br>Scythe,<br>Voulge,<br>War Scythe<br></span></td></tr>
</table>
<br>

<table class='head ios-visible'>
    <tr><td>
        <table class='head' id='table.pl2'>
            <tr class='rt rb'><th      > Power Leveling<div class='collapse'><button value='table.pl2' onclick='onCollapse(this);'>-</button></div></th></tr>
            <tr><td class='tooltip b11'> 1-15 Tristram runs      </td></tr>
            <tr><td class='tooltip b22'>15-24 Tombs (Cows 21-24) </td></tr>
            <tr><td class='tooltip b11'>   24 Ancients           </td></tr>
            <tr><td class='tooltip b22'>25-40 Sanctuary/Baal     </td></tr>
            <tr><td class='tooltip g11'>   40 Ancients       (nm)</td></tr>
            <tr><td class='tooltip g22'>41-60 Sanctuary/Baal (nm)</td></tr>
            <tr><td class='tooltip r11'>   60 Ancients     (Hell)</td></tr>
            <tr><td class='tooltip r22'>41-60 Baal         (Hell)</td></tr>
        </table>
    </td>
    <td class='vatop padd5'>
        <table id='table.bestxp2'>
            <tr class='gt gb'><th      >Best XP    I      II     III    IV     V<div class='collapse'><button value='table.bestxp2' onclick='onCollapse(this);'>-</button></div></th></tr>
            <tr><td class='tooltip b22'>Normal      1-11  12-18  19-23  24-31  32-36</td></tr>
            <tr><td class='tooltip g22'>Nightmare  37-43  44-48  49-52  53-62  skip </td></tr>
            <tr><td class='tooltip r22'>Hell       63-73  74-80  81-83  83-94  95-99</td></tr>
        </table>
        <br>
        <table id='table.bases4sword'>
            <tr class='bt bb'><th      >4os sword bases: Crystal, Broad, Long, ilvl 26-40<div class='collapse'><button value='table.bases4sword' onclick='onCollapse(this);'>-</button></div></th></tr>
            <tr><td class='tooltip b11'>Normal    Act 5                                    </td></tr>
            <tr><td class='tooltip b22'>Normal    Cows                                     </td></tr>
            <tr><td class='tooltip b11'>Nightmare Act 1                                    </td></tr>
        </table>
    </td></tr>
</table>
<br>
<table>
    <tr>
        <td class='vatop'>
<table class='head' id='table.alvl1'>
    <tr class='bt bb'><th><a href='http://classic.battle.net/diablo2exp/maps/act1.shtml'><div class='wp'></div></a></th><th>I Rogue Encampment       N  nm   H <span class='l'>Left</span>/<span class='c'>S</span>/<span class='r'>Right</span>  <button value='table.alvl1' onclick='onCollapse(this);'>-</button></th></tr>
    <tr><td                      ></td><td class='tooltip b11'>Blood Moor               1  36  <meta              />67<meta/> <span class='l'>   </span      ><span class='c' >Follow path</span ><span class='r'  >   </span></td></tr>
    <tr><td                      ></td><td class='tooltip b22'>  Den of Evil            1  36  <meta              />79<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip b11'>Cold Plains              2  36  <meta              />68<meta/> <span class='l'>   </span      ><span class='c' >Follow path</span ><span class='r'  >   </span></td></tr>
    <tr><td                      ></td><td class='tooltip b22'>  The Cave Level 1       2  36  <meta              />77<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip b11'>  The Cave Level 2       2  37  <meta              />78<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip b22'>Burial Grounds           3  36  <meta              />80<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip b11'>  The Crypt              3  37  <span class='alvl83'>83</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip b22'>  The Mausoleum          3  37  <span class='alvl85'>85</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip b11'>Stony Field              4  37  <meta              />68<meta/> <span class='l'>   </span      ><span class='c' >Follow path</span ><span class='r'  >   </span></td></tr>
    <tr><td                      ></td><td class='tooltip b22'>  Tristram               6  39  <meta              />76<meta/> <span class='l'>  </span       ><span class='c'>Cairn by path</span><span class='r'   >  </span></td></tr>
    <tr><td                      ></td><td class='tooltip b11'>Underground Passage 1    4  37  <meta              />69<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>Right</span></td></tr>
    <tr><td                      ></td><td class='tooltip b22'>  Underground Passage 2  4  38  <span class='alvl83'>83</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip b11'>Dark Wood                5  38  <meta              />68<meta/> <span class='l'>   </span      ><span class='c' >Follow path</span ><span class='r'  >   </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip b22'>Black Marsh              6  38  <meta              />69<meta/> <span class='l'>   </span      ><span class='c' >Follow path</span ><span class='r'  >   </span></td></tr>
    <tr><td                      ></td><td class='tooltip b11'>  Tower Cellar Level 1   7  38  <meta              />75<meta/> <span class='l'>Left</span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip b22'>    Tower Cellar Level 2 7  39  <meta              />76<meta/> <span class='l'>Left</span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip b11'>    Tower Cellar Level 3 7  40  <meta              />77<meta/> <span class='l'>Left</span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip b22'>    Tower Cellar Level 4 7  41  <meta              />78<meta/> <span class='l'>Left</span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip b11'>    Tower Cellar Level 5 7  42  <meta              />79<meta/> <span style='font-size:6px;'>If you need help here...</span                                     ></td></tr>
    <tr><td                      ></td><td class='tooltip b22'>  The Hole Level 1       5  38  <meta              />80<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip b11'>    The Hole Level 2     5  39  <meta              />81<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip b22'>Tamoe Highland           8  39  <meta              />69<meta/> <span class='l'>   </span      ><span class='c' >Follow path</span ><span class='r'  >   </span></td></tr>
    <tr><td                      ></td><td class='tooltip b11'>  The Pit Level 1        7  39  <span class='alvl85'>85</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip b22'>  The Pit Level 2        7  40  <span class='alvl85'>85</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip b11'>Monastery Gate           8  40  <meta              />70<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip b22'>Outer Cloister           9  40  <meta              />70<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip b11'>Barracks                 9  40  <meta              />70<meta/> <span class='l'>Left</span     > or <span class='c'  >Straight</span   ><span class='r'> </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip b22'>  Jail Level 1          10  41  <meta              />71<meta/> <span class='l'>    </span     ><span class='c'  >Straight</span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip b11'>  Jail Level 2          10  41  <meta              />71<meta/> <span class='l'>    </span     ><span class='c'  >Straight</span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip b22'>  Jail Level 3          10  41  <meta              />71<meta/> <span class='l'>Left</span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip b11'>Inner Cloister          10  41  <meta              />72<meta/> <span class='l'>Left</span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip b22'>Cathedral               11  42  <meta              />72<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>Right</span></td></tr>
    <tr><td                      ></td><td class='tooltip b11'>  Catacombs Level 1     11  42  <meta              />72<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip b22'>  Catacombs Level 2     11  42  <meta              />73<meta/> <span class='l'>    </span     ><span class='c'  >     </span      ><span class='r'>wp&rarr;Right</span></td></tr>
    <tr><td                      ></td><td class='tooltip b11'>  Catacombs Level 3     12  43  <meta              />73<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip b22'>  Catacombs Level 4     12  43  <meta              />73<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip b11'>Secret Cow Level        28  64  <meta              />81<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
</table><br><table class='head' id='table.alvl2'>
    <tr class='yt yb'><th><a href='http://classic.battle.net/diablo2exp/maps/act2.shtml'><div class='wp'></div></a></th><th>II Lut Gholein           N  nm   H <span class='l'>Left</span>/<span class='c'>S</span>/<span class='r'>Right</span>  <button value='table.alvl2' onclick='onCollapse(this);'>-</button></th></tr>
    <tr><td                      ></td><td class='tooltip y11'>  Sewers Level 1        13  43  <meta              />74<meta/> <span class='l'>    </span     ><span class='c' >  </span><span class='r'>Chest&rarr;Right</span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip y22'>  Sewers Level 2        13  43  <meta              />74<meta/> <span class='l'>wp&rarr;L</span><span class='c' >Straight</span><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip y11'>  Sewers Level 3        14  44  <meta              />75<meta/> <span class='l'>Left</span     ><span class='c' >        </span><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip y22'>Rocky Waste             14  43  <meta              />75<meta/> <span class='l'>    </span     ><span class='c' >        </span><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip y11'>  Stony Tomb Level 1    12  44  <meta              />78<meta/> <span class='l'>Left</span     ><span class='c' >        </span><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip y22'>  Stony Tomb Level 2    12  44  <meta              />79<meta/> <span class='l'>Chest</span    ><span class='c'  > Boss  </span><span class='r'>     </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip y11'>Dry Hills               15  44  <meta              />76<meta/> <span class='l'>    </span     ><span class='c' >        </span><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip y22'>  Halls of the Dead 1   12  44  <meta              />79<meta/> <span class='l'>Left</span     ><span class='c' >        </span><span class='r'>     </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip y11'>    Halls of the Dead 2 13  45  <meta              />81<meta/> <span class='l'>Left</span     ><span class='c' >   wp   </span><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip y22'>    Halls of the Dead 3 13  45  <meta              />82<meta/> <span class='l'>Left</span     ><span class='c' >        </span><span class='r'>     </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip y11'>Far Oasis               16  45  <meta              />76<meta/> <span class='l'>    </span     ><span class='c' >        </span><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip y22'>  Maggot Lair Level 1   17  45  <span class='alvl84'>84</span> <span class='l'>    </span     ><span class='c' >        </span><span class='r'>Right</span></td></tr>
    <tr><td                      ></td><td class='tooltip y11'>    Maggot Lair Level 2 17  45  <span class='alvl84'>84</span> <span class='l'>    </span     ><span class='c' >        </span><span class='r'>Right</span></td></tr>
    <tr><td                      ></td><td class='tooltip y22'>    Maggot Lair Level 3 17  46  <span class='alvl85'>85</span> <span class='l'>    </span     ><span class='c' >Straight</span><span class='r'>     </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip y11'>Lost City               17  46  <meta              />77<meta/> <span class='l'>    </span     ><span class='c' >        </span><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip y22'>  Ancient Tunnels       17  46  <span class='alvl85'>85</span> <span class='l'>Chest</span    ><span class='c'  >       </span><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip y11'>Valley of Snakes        18  46  <meta              />77<meta/> <span class='l'>    </span     ><span class='c' >        </span><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip y22'>  Claw Viper Temple 1   14  47  <meta              />82<meta/> <span class='l'>Left</span     ><span class='c' >        </span><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip y11'>  Claw Viper Temple 2   14  47  <span class='alvl83'>83</span> <span class='l'>    </span     ><span class='c' >        </span><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip y22'>Harem Level 2           13  47  <meta              />78<meta/> <span class='l'>    </span     ><span class='c' >        </span><span class='r'>     </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip y11'>  Palace Cellar 1       13  47  <meta              />78<meta/> <span class='l'>    </span     ><span class='c' >        </span><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip y22'>  Palace Cellar 2       13  47  <meta              />78<meta/> <span class='l'>    </span     ><span class='c' >        </span><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip y11'>  Palace Cellar 3       13  48  <meta              />78<meta/> <span class='l'>    </span     ><span class='c' >        </span><span class='r'>     </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip y22'>Arcane Sanctuary        14  48  <meta              />79<meta/> <span class='l'> RNG</span     ><span class='c' >esus    </span><span class='r'>     </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip y11'>Canyon of the Magi      16  48  <meta              />79<meta/> O<span class='rot90'> )</span>▯   *   ⩔△<span class='rot90'>o)<span></td></tr>
    <tr><td                      ></td><td class='tooltip y22'>Tal Rasha's Tomb        17  49  <meta              />80<meta/> <span class='l'>Orifice</span  ><span class='c'    >     </span><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip y11'>Tal Rasha's Chamber     17  49  <meta              />80<meta/> <span class='l'>    </span     ><span class='c' >        </span><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td><img alt='Tomb Symbols: O ) [] * v /\ O)' src='pics/tomb_symbols.png' style='width:450px;'></td></tr>
</table><br></td><td class='vatop'><table class='head' id='table.alvl3'>
    <tr class='gt gb'><th><a href='http://classic.battle.net/diablo2exp/maps/act3.shtml'><div class='wp'></div></a></th><th>III Kurast Docs          N  nm   H <span class='l'>Left</span>/<span class='c'>S</span>/<span class='r'>Right</span>  <button value='table.alvl3' onclick='onCollapse(this);'>-</button></th></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip g11'>Spider Forest           21  49  <meta              />79<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip g22'>  Arachnid Lair         21  50  <meta              />79<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip g11'>  Spider Cavern         21  50  <meta              />79<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip g22'>Great Marsh             21  50  <meta              />80<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip g11'>Flayer Jungle           22  50  <meta              />80<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip g22'>  Swampy Pit Level 1    21  51  <meta              />80<meta/> <span class='l'>Left</span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip g11'>    Swampy Pit Level 2  21  51  <meta              />81<meta/> <span class='l'>Left</span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip g22'>    Swampy Pit Level 3  21  51  <meta              />82<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip g11'>  Flayer Dungeon 1      22  51  <meta              />81<meta/> <span class='l'>Left</span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip g22'>    Flayer Dungeon 2    22  51  <meta              />82<meta/> <span class='l'>Left</span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip g11'>    Flayer Dungeon 3    22  51  <span class='alvl83'>83</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip g22'>Lower Kurast            22  52  <meta              />80<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip g11'>Kurast Bazaar           22  52  <meta              />81<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip g22'>  Disused Fane          23  53  <span class='alvl84'>84</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip g11'>  Ruined Temple         23  53  <span class='alvl84'>84</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip g22'>  Sewers Level 1        23  52  <span class='alvl84'>84</span> <span class='l'>    </span     ><span class='c'  >  </span        ><span class='r'>chest&rarr;Right</span></td></tr>
    <tr><td                      ></td><td class='tooltip g11'>    Sewers Level 2      24  53  <span class='alvl85'>85</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip g22'>Upper Kurast            23  52  <meta              />81<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip g11'>  Forgotten Temple      24  54  <span class='alvl85'>85</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip g22'>  Forgotten Reliquary   23  53  <span class='alvl84'>84</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip g11'>Kurast Causeway         24  53  <meta              />81<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip g22'>  Disused Reliquary     24  54  <span class='alvl85'>85</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip g11'>  Ruined Fane           24  54  <span class='alvl85'>85</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip g22'>Travincal               24  54  <meta              />82<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip g11'>  Durance of Hate 1     25  55  <span class='alvl83'>83</span> <span class='l'>Left</span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip g22'>  Durance of Hate 2     25  55  <span class='alvl83'>83</span> <span class='l'> wp </span     ><span class='c' >Straight</span    ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip g11'>    DoH 2 (from wp)             <meta              />  <meta/> <span class='l'>wp&rarr;Left</span><span class='c'     >     </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip g22'>  Durance of Hate 3     25  55  <span class='alvl83'>83</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
</table><br><table class='head' id='table.alvl4'>
    <tr class='rt rb'><th><a href='http://classic.battle.net/diablo2exp/maps/act4.shtml'><div class='wp'></div></a></th><th>IV Pandemonium Fortress  N  nm   H <span class='l'>Left</span>/<span class='c'>S</span>/<span class='r'>Right</span>  <button value='table.alvl4' onclick='onCollapse(this);'>-</button></th></tr>
    <tr><td                      ></td><td class='tooltip r11'>Outer Steppes           26  56  <meta              />82<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip r22'>Plains of Despair       26  56  <span class='alvl83'>83</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip r11'>City of the Damned      27  57  <span class='alvl84'>84</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip r22'>River of Flame          27  57  <span class='alvl85'>85</span> <span class='l'>    </span     ><span class='c'  >Straight</span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip r11'>Chaos Sanctuary         28  58  <span class='alvl85'>85</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
</table><br><table class='head' id='table.alvl5'>
    <tr class='kt kb'><th><a href='http://classic.battle.net/diablo2exp/maps/act5.shtml'><div class='wp'></div></a></th><th>V Harrogath              N  nm   H <span class='l'>Left</span>/<span class='c'>S</span>/<span class='r'>Right</span>  <button value='table.alvl5' onclick='onCollapse(this);'>-</button></th></tr>
    <tr><td                      ></td><td class='tooltip k11'>Bloody Foothills        24  58  <meta              />80<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip k22'>Frigid Highlands        25  59  <meta              />81<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip k11'>  Abaddon               39  60  <meta              />81<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip k22'>Arreat Plateau          26  60  <meta              />81<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip k11'>  Pit of Acheron        39  61  <meta              />82<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip k22'>Crystalline Passage     29  61  <meta              />82<meta/> <span class='l'>Left</span     ><span class='c'  > S&rarr;FR   </span   ><span class='r'>wp   </span></td></tr>
    <tr><td                      ></td><td class='tooltip k11'>  Frozen River          29  61  <span class='alvl83'>83</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip k22'>Nihlathak's Temple      32  63  <span class='alvl83'>83</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip k11'>  Halls of Anguish      33  63  <span class='alvl83'>83</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip k22'>  Halls of Pain         34  64  <span class='alvl84'>84</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip k11'>  Halls of Vaught       36  64  <span class='alvl84'>84</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip k22'>Glacial Trail           29  61  <span class='alvl83'>83</span> <span class='l'>Left</span     ><span class='c'  >        </span   ><span class='r'>wp   </span></td></tr>
    <tr><td                      ></td><td class='tooltip k11'>  Drifter Cavern        29  61  <span class='alvl84'>84</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip k22'>Frozen Tundra           27  60  <meta              />81<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip k11'>  Infernal Pit          39  62  <span class='alvl83'>83</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip k22'>The Ancients' Way       29  62  <meta              />82<meta/> <span class='l'>Left</span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip k11'>  Icy Cellar            29  62  <span class='alvl83'>83</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip k22'>Arreat Summit           37  68  <meta              />87<meta/> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip k11'>  The Worldstone Keep 1 39  65  <span class='alvl85'>85</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td><div class='wp'></div></td><td class='tooltip k22'>  The Worldstone Keep 2 40  65  <span class='alvl85'>85</span> <span class='l'>    </span     ><span class='c'  >     </span      ><span class='r'>wp&rarr;Right</span></td></tr>
    <tr><td                      ></td><td class='tooltip k11'>  The Worldstone Keep 3 42  66  <span class='alvl85'>85</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip k22'>Throne of Destruction   43  66  <span class='alvl85'>85</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip k11'>  Worldstone Chamber    43  66  <span class='alvl85'>85</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
<tr class='kt'><td               ></td><td class='tooltip k22'>Forgotten Sands         --  --  <span class='alvl83'>83</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip k11'>Furnace of Pain         --  --  <span class='alvl83'>83</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip k22'>Matron's Den            --  --  <span class='alvl83'>83</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    <tr><td                      ></td><td class='tooltip k11'>Über Tristram           --  --  <span class='alvl83'>83</span> <span class='l'>    </span     ><span class='c'  >        </span   ><span class='r'>     </span></td></tr>
    </table>
    <br>
            <table class='head'>
                <tr class='yt yb'><th><a href='https://fabd.github.io/diablo2/wiki/experience'>alvl</a >  Champions  Uniques   TC 87</th></tr>
                <tr><td class='tooltip g11'><span class='alvl83'                              > 83</span>      85+       86+     no </th></tr>
                <tr><td class='tooltip b22'><span class='alvl84'                              > 84</span>      86        88      yes</th></tr>
                <tr><td class='tooltip r11'><span class='alvl85'                              > 85</span>      87        88      yes</th></tr>
            </table>
        </td>
    </tr>
</table>
<table class='head'>
    <tr class='vatop'>
        <td>
            <table>
                <tr><th>Layout: From area <span class='rev'>ENTRANCE</span> unless specified</th></tr>
                <tr class='pre'><td>  <span class='l'>Left      </span>go <span class='l'>left</span> / CW for next area</td></tr>
                <tr class='pre'><td>  <span class='c'>Straight  </span>go <span class='c'>straight</span>  for next area</td></tr>
                <tr class='pre'><td>  <span class='c'>S&rarr;FR      </span>go <span class='c'>Straight</span> for Frozen River</td></tr>
                <tr class='pre'><td>  <span class='r'>Right     </span>go <span class='r'>right</span>/CCW for next area</td></tr>
            </table>
        </td>
        <td style='padding-left: 2em;'>
            <table class='head'>
                <tr class='pre'><td><span class='l'>wp&rarr;Left </span>  As you leave the <span class='note'>waypoint</span> tile go <span class='l'>Left </span> to the next area</td></tr>
                <tr class='pre'><td><span class='r'>wp&rarr;Right</span>  As you leave the <span class='note'>waypoint</span> tile go <span class='r'>Right</span> to the next area</td></tr>
                <tr class='pre'><td><span class='r'>chest&rarr;R</span>   From <i>chest</i> go <span class='r'>Right</span> to level 2</td></tr>
                <tr class='pre'><td>Chest     Direction leads to chest</td></tr>
                <tr class='pre'><td>Boss      Direction leads to mini-boss</td></tr>
            </table>
        </td
    </tr>
</table>
<hr>
<pre>
<b>Feedback:</b>
   Please leave feedback in my reddit <a href="https://www.reddit.com/r/diablo2/comments/pmv4u3/my_diablo_2_cheat_sheet/">thread</a> or create a <a href="https://github.com/Michaelangel007/d2_cheat_sheet/issues">new</a> GitHub issue.
   You can find a roadmap / wishlist of features in the <a href="https://github.com/Michaelangel007/d2_cheat_sheet#wishlist">Readme</a>.

   I also monitor these threads for suggestions (just not as frequent):

      * <a href='https://us.forums.blizzard.com/en/d3/t/diablo-2-cheat-sheet-runesrunewordsbpstc85resources/44944'>https://us.forums.blizzard.com/en/d3/t/diablo-2-cheat-sheet-runesrunewordsbpstc85resources/44944</a>
      * <a href='https://forums.d2jsp.org/topic.php?t=85564403&f=384&o=0'>https://forums.d2jsp.org/topic.php?t=85564403&f=384&o=0</a>
      * <a href='https://diablo2.io/forums/diablo-2-mega-cheat-sheet-runes-runewords-bps-tc85-resources-t8651.html'>https://diablo2.io/forums/diablo-2-mega-cheat-sheet-runes-runewords-bps-tc85-resources-t8651.html</a>

<b>Legend:</b>
    <i>*  </i> See note / S-Tier item           <i>alvl</i>     Area Level
    <i>LK </i> Lower Kurast, Act 3 area         <i>clvl</i>     Character Level
        (<span class='note'>Farm chests for runes</span>)          <i>ilvl</i>     Item Level; hidden number used to determine affixes
    <i>TC </i> Treasure Class (drop pool)                (<span class='note'>This is NOT the character level required to equip the item!</span>)
    <i>tp </i> town portal                               (i.e. <span class='note'>Act 2 mlvl 23 unique boss +3 can drop Tal's amy clvl 67</span>)
    <i>wp </i> Waypoint                         <i>mlvl</i>     Monster Level
    <i>#os</i> Number of open sockets in armor  <i>base</i>     Item type used for making runewords
        (Body, Helm, Shield, Weapon)     <i>affix</i>    An effect applied to weapon/armor. i.e. <span class='cb'>Crushing Blow</span>
        e.g. 1os, 2os, ..., 6os          <i>skillers</i> Grand Charm with +1 to skills

<table><tr><td><pre>
  Offense:
    <span class='skill'>+# To All Skills</span>
    <span class='cb'   >##</span> Crushing Blow
    <span class='ds'   >##</span> Deadly Strike
    <span class='fcr'  >##</span> Faster Caster Rate
    <span class='idr'  >  <meta/> Ignores Target's Defense</span>
    <span class='ias'  >##</span> Increased Attack Speed
    <span class='ow'   >##</span> Open Wounds

  Misc:
    <span class='gold'>##</span> Extra Gold From Monsters
    <span class='mf'  >##</span> Better Chance of Getting Magic Items
</pre></td><td><pre>
  Defense:
    <span class='dr'   >##</span> Damage Reduced
    <span class='fbr'  >##</span> Faster Block Rate
    <span class='fhr'  >##</span> Faster Hit Recovery

    <span class='resf' >##</span> Fire Resist
    <span class='resc' >##</span> Cold Resist
    <span class='resl' >##</span> Lightning Resist
    <span class='resp' >##</span> Poison Resist
    <span class='resm' style='padding-left:0.75ch; padding-right:0.75ch;'>m</span> Magic Resist
    <span class='resh' style='padding-left:0.75ch; padding-right:0.75ch;'>p</span> Physical Resist
    <span class='resa' >##</span> Resist All (Fire, Cold, Lightning, Poison)
    <span class='cbf'  >  <meta/> Cannot Be Frozen</span>
</pre>  </td>
    </tr>
</table>
<b>Instructions:</b>
  Runes
    Click on "None" to own no runes.
    Click on "All"  to own all runes (default).
    Click on a rune image to toggle owning that rune.

  Runewords
    Click on "S"       to sort runewords by S tier.
    Click on "Name"    to sort runewords by name.
    Click on "Sock"    to sort runewords by sockets.
    Click on "Owned"   to sort runewords by those you can make.  Click on the rune to toggle owning it.
    Click on "Runes"   to sort runewords by runes.
    Click on "Lev"     to sort runewords by minimum character level required to equip.
    Click on "Version" to sort runewords by version (default).

<b>Misc. Links:</b>
  Abbreviations
    * <a href='https://diablo2.diablowiki.net/Abbreviations_and_Acronyms'>https://diablo2.diablowiki.net/Abbreviations_and_Acronyms</a>
  Calcs
    * <a href='https://d2.maxroll.gg/d2planner/'>https://d2.maxroll.gg/d2planner/</a> -- Awesome offline character + gear planner
    * <a href='https://d2.maxroll.gg/d2-drop-calculator'>https://d2.maxroll.gg/d2-drop-calculator</a> -- Drop Calculator
    * <a href='https://dropcalc.silospen.com/item.php'>https://dropcalc.silospen.com/item.php</a> -- Drop Calculator
    * <a href='https://pairofdocs.github.io/d2-dropsim-web/'>https://pairofdocs.github.io/d2-dropsim-web/</a> -- Boss and monster drop simulator
    * <a href='https://planetdiablo.eu/diablo2/calcs/speedcalc/speedcalc_english.php'>https://planetdiablo.eu/diablo2/calcs/speedcalc/speedcalc_english.php</a> -- Attack speed calc (English & German)
  Utils
    * <a href='https://d2-holy-grail.herokuapp.com/'>https://d2-holy-grail.herokuapp.com/</a> -- "Holy Grail" collectable tracker
    * <a href='https://github.com/youdz/d2-stash-organizer'>https://github.com/youdz/d2-stash-organizer</a> -- PlugY stash tab organizer
    * <a href='https://d2runewizard.com/'>https://d2runewizard.com/</a> -- Runeword Wizard
    * <a href='https://diablo.fandom.com/wiki/Area_Level'>Area Level</a> -- alvl by Zone &rarr; mlvl (Monster Level)
  Map layout reading
    * <a href='https://d2.maxroll.gg/resources/map-reading'>https://d2.maxroll.gg/resources/map-reading</a> -- map layout guide
    * <a href='https://nightfallx2.wixsite.com/d2speedruns/map-layouts'>https://nightfallx2.wixsite.com/d2speedruns/map-layouts</a> -- map layout guide
    * <a href='https://www.youtube.com/watch?v=iaAmrldC3c4'>https://www.youtube.com/watch?v=iaAmrldC3c4</a> -- MrLlamaSC map reading guide
  Leveling
    * <a href='https://d2.maxroll.gg/meta/0-to-baal-hell-meta'>https://d2.maxroll.gg/meta/0-to-baal-hell-meta</a> -- power leveling for 8 party
  Farming
    * <a href='https://www.almarsguides.com/Computer/Games/Diablo2/Farming/Locations/Act1/ThePit/'>https://www.almarsguides.com/Computer/Games/Diablo2/Farming/Locations/Act1/ThePit/</a> -- pit farming
  Runeswords
    * <a href='http://classic.battle.net/diablo2exp/items/runewords-original.shtml'>Original Runewords</a>
    * <a href="http://classic.battle.net/diablo2exp/items/runewords-110.shtml">1.10 Runewords</a>
    * <a href="http://classic.battle.net/diablo2exp/items/runewords-110.shtml">1.10 Runewords (Ladder)</a>
    * <a href="http://classic.battle.net/diablo2exp/items/runewords-111.shtml">1.11 Rune Words</a> (+2 to {class} Skill Levels)
    * <a href="https://i.imgur.com/2nTUs.png">Original inspiration</a> -- Diablo II Upgrading and Information
  Trading
    * <a href='https://diablo2.io/price-check'>https://diablo2.io/price-check </a> -- History of Item Price
    * <a href='https://traderie.com/diablo2resurrected'>https://traderie.com/diablo2resurrected</a> -- Trade Site
    * <a href='https://diablo2.io/trade/'>https://diablo2.io/trade/</a> -- Trade Site
    * <a href='D2jsp.org'>D2jsp.org</a> -- Trade Site

Thanks:
  * /u/Obliivescence        for catching   TC84 header info
  * /u/Fragrant_Draws       for catching   broken user name link
  * /u/Drak_Gaming          for catching   Ama 1H and 2H FBR being swapped
  * /u/Lysgaard_dk          for catching   Power Leveling 61+
  * /u/Ultimate600          for catching   BoTD not S-Tier
  * /u/wariscrafty          for catching   Lazarus
  * /u/Ansive               for catching   a few Crafting recipes
  * /u/Mateusz_Macheta      for catching   a few directions
  * /u/Separate-Tomatillo87 for suggestion of HOTO to use Flail instead of Mace*
  * /u/MestreJonas_         for suggestion to clarify "lite/othr"
  * /u/randomly-generated   for suggestion to sort runewords by owned
  * /u/GuardianOfTriangles  for suggestion of more S Tier items (Black, Exile, Obedience, or White)
  * /u/Subearoo             for suggestion of 6 pskulls rerolling rares
  * /u/Cromi38              for suggestion of waypoint icons
  * /u/jamexxx              for suggestion of Essences
  * /u/thrownawayzss        for suggestion of less bright yellow hover bar for night time
  * /u/Saphirar             for reminder   of d2.maxroll.gg d2planner
  * /u/Cormair              for suggestion of alt. links to d2.maxroll.gg drop calc, holy grail, stash tab organizer
  * /u/Push4h               for suggestion of add monochrome support
  * /u/josh06025            for suggestion of color code high level alvl
  * /u/soupsticle           for suggestion of attack speed calc, FBR, and collapsible tables
  * /u/tk4481               for suggestion of d2.maxroll.gg map reading
  * /u/post_ex0dus          for suggestion of power leveling
  * /u/pisseningly          for suggetsion of collapse all button
  * /u/wariscrafty          for link to       drop calc
  * /u/LivEisJeebus         for suggestion of gambling odds and items
  * /u/HutchReddit          for suggestion of skillers for rerolling magic item
  * /uGuardianOfTriangles   for suggestion of savage cube recipe
  * /u/Kairukun90           for suggestion of runeword manifest
  * /u/Hezkezl              for suggestion of L/C/R cleanup
  * /u/-Rhialto-            for suggestion of linking version number to git commit history
  * pairofdocs              for suggestion of recharging items and example of Teleport staff
  * MarcusQuixabeira        for tweaking   of tooltip x position to not cover "Fav" button
  * ZehelFenris             for catching   of Act 3 caves being listed in wrong zone
  * huggarn                 for catching   of Cows not on Power Leveling
  * hajinks                 for catching   of Perfect Topaz lightning resist
</pre>
<hr class='one'>
<span style='font-size:12px;'>Version <a href="https://github.com/Michaelangel007/d2_cheat_sheet/commits">1.60</a>, Last Updated Sun, Oct 31 2021.</span>
<span style='font-size:10px;'>CSS Debug: Screen Size:</span> <span id='screen-size'>?</span>, <span class='ios-hidden' >iOS-hidden</span> <span class='ios-visible'>iOS-visible</span>
<span style='font-size:6px;'>All bugs are due to Anthony slacking on QA.</span>
</div></body>
</html>
